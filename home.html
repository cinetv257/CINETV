<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>CINETV - Streaming de Films et Séries</title>
  <link rel="icon" href="logo.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRSJ4J6W6P"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DRSJ4J6W6P');
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    :root {
      --bg: #0a0a12;
      --panel: rgba(18, 18, 32, 0.95);
      --panel-2: #1e2038;
      --text: #ffffff;
      --muted: #b2b4d6;
      --brand: #6a67ff;
      --brand-light: #8b88ff;
      --action: #4a6cf7;
      --success: #3dd598;
      --danger: #ff6b6b;
      --warning: #ffd166;
      --transition: all 0.3s ease;
      --title-color: #6a67ff;
      --interpreter-color: #88d3ff;
      --year-color: #ff88b1;
      --gradient: linear-gradient(135deg, #6a67ff 0%, #4a6cf7 100%);
      --badge-color: #ff6b6b;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.4);
    }
    
    body {
      background: var(--bg) url('background.jpg') center/cover no-repeat fixed;
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 74px;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: rgba(10, 10, 18, 0.88);
      backdrop-filter: blur(10px);
      z-index: -1;
    }
    
    /* ======= NAVBAR ======= */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 68px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 1000;
      padding: 0 20px;
      background: rgba(18, 18, 32, 0.85);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 800;
      text-decoration: none;
      color: var(--text);
      letter-spacing: 0.5px;
      font-size: 1.35rem;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .logo-img {
      width: 32px;
      height: 32px;
      object-fit: contain;
    }
    
    .navbar-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .auth-btn {
      background: rgba(106, 103, 255, 0.1);
      border: 1px solid rgba(106, 103, 255, 0.3);
      color: var(--brand);
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .auth-btn:hover {
      background: rgba(106, 103, 255, 0.2);
      transform: translateY(-2px);
    }
    
    .user-menu {
      display: none;
      align-items: center;
      gap: 10px;
      background: rgba(106, 103, 255, 0.1);
      border: 1px solid rgba(106, 103, 255, 0.3);
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .user-menu:hover {
      background: rgba(106, 103, 255, 0.2);
      transform: translateY(-2px);
    }
    
    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.9rem;
    }
    
    .hamburger {
      background: transparent;
      border: none;
      color: #fff;
      font-size: 1.3rem;
      cursor: pointer;
      padding: 10px;
      border-radius: 10px;
      transition: var(--transition);
      background: rgba(255, 255, 255, 0.05);
    }
    
    .hamburger:hover {
      background: rgba(106, 103, 255, 0.2);
      color: var(--brand);
    }
    
    /* ======= DRAWER ======= */
    .drawer-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.65);
      opacity: 0;
      pointer-events: none;
      transition: 0.25s;
      z-index: 110;
      backdrop-filter: blur(4px);
    }
    
    .drawer {
      position: fixed;
      inset: 0 auto 0 0;
      width: min(90%, 380px);
      background: rgba(30, 32, 56, 0.95);
      transform: translateX(-100%);
      transition: transform 0.35s cubic-bezier(0.22, 1, 0.36, 1);
      z-index: 111;
      display: flex;
      flex-direction: column;
      backdrop-filter: blur(15px);
      border-right: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .drawer-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .drawer-title {
      font-weight: 800;
      font-size: 1.25rem;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .drawer-logo {
      width: 28px;
      height: 28px;
      object-fit: contain;
    }
    
    .drawer-body {
      padding: 16px 16px 30px 16px;
      overflow: auto;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }
    
    .drawer-section-title {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--muted);
      margin-bottom: 12px;
      padding: 0 16px;
      font-weight: 600;
    }
    
    .cat-list {
      list-style: none;
      display: grid;
      gap: 8px;
    }
    
    .cat-list a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      text-decoration: none;
      background: rgba(255, 255, 255, 0.03);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.06);
      transition: var(--transition);
      font-weight: 500;
    }
    
    .cat-list a:hover {
      background: rgba(106, 103, 255, 0.15);
      border-color: var(--brand);
      transform: translateX(4px);
    }
    
    .cat-list a i {
      width: 22px;
      text-align: center;
      font-size: 1.1rem;
    }

    .cat-list a.option-search {
      color: var(--action);
    }
    .cat-list a.option-premium {
      color: var(--warning);
    }
    .cat-list a.option-contact {
      color: var(--success);
    }
    .cat-list a.option-privacy {
      color: var(--muted);
    }

    .all-categories {
      display: none;
      grid-template-columns: 1fr;
      gap: 8px;
      margin-top: 12px;
    }

    .all-categories.show {
      display: grid;
    }
    
    .see-more {
      display: inline-block;
      margin-top: 10px;
      padding: 10px 16px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      color: var(--muted);
      font-size: 0.85rem;
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .see-more:hover {
      background: rgba(106, 103, 255, 0.15);
      color: var(--brand);
    }
    
    .drawer-open .drawer {
      transform: translateX(-0);
    }
    
    .drawer-open .drawer-overlay {
      opacity: 1;
      pointer-events: auto;
    }
    
    /* ======= HERO SLIDER ======= */
    .hero-slider {
      position: relative;
      height: 70vh;
      overflow: hidden;
      margin-top: 68px;
    }

    @media (max-width: 480px) {
      .hero-slider {
        height: 60vh;
      }
    }

    .slider-container {
      display: flex;
      height: 100%;
      transition: transform 0.5s cubic-bezier(0.33, 1, 0.68, 1);
    }

    .slide {
      position: relative;
      min-width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: flex-end;
      padding: 40px 6%;
    }

    @media (max-width: 480px) {
      .slide {
        padding: 30px 5%;
      }
    }

    .slide::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.7) 50%, rgba(10, 10, 18, 0.95) 100%);
    }

    .slide-content {
      position: relative;
      z-index: 1;
      max-width: 750px;
    }

    .slide h1 {
      font-size: clamp(24px, 5vw, 48px);
      margin-bottom: 12px;
      line-height: 1.2;
      font-weight: 800;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    
    .slide-meta {
      color: var(--muted);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .slide-meta span {
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.08);
      padding: 6px 10px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      font-size: 0.85rem;
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 14px 26px;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 700;
      transition: var(--transition);
      border: none;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .btn-primary {
      background: var(--gradient);
      color: #fff;
      box-shadow: 0 4px 20px rgba(106, 103, 255, 0.35);
    }
    
    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(106, 103, 255, 0.5);
    }

    .slider-indicator {
      position: absolute;
      bottom: 20px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      z-index: 2;
    }

    .slider-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.25);
      cursor: pointer;
      transition: var(--transition);
    }

    .slider-dot.active {
      background: var(--brand);
      transform: scale(1.3);
      box-shadow: 0 0 10px rgba(106, 103, 255, 0.7);
    }
    
    /* ======= SECTIONS ======= */
    .section {
      padding: 28px 5%;
      position: relative;
    }
    
    @media (max-width: 480px) {
      .section {
        padding: 24px 4%;
      }
    }
    
    .section h2 {
      font-size: 1.3rem;
      margin-bottom: 18px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
    }

    @media (max-width: 480px) {
      .section h2 {
        font-size: 1.2rem;
        margin-bottom: 16px;
      }
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    /* ======= HORIZONTAL SCROLL ======= */
    .scroll-container {
      position: relative;
    }

    .scroll-content {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      gap: 12px;
      padding-bottom: 16px;
      scrollbar-width: none; /* Firefox */
    }

    .scroll-content::-webkit-scrollbar {
      display: none; /* Chrome/Safari */
    }

    .card {
      position: relative;
      background: var(--panel-2);
      border-radius: 14px;
      overflow: hidden;
      cursor: pointer;
      transform: translateZ(0);
      scroll-snap-align: start;
      transition: var(--transition);
      flex: 0 0 calc(33.333% - 8px);
      min-width: calc(33.333% - 8px);
      text-decoration: none;
      color: inherit;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    @media (max-width: 360px) {
      .card {
        flex: 0 0 calc(33.333% - 8px);
        min-width: calc(33.333% - 8px);
      }
    }

    @media (min-width: 640px) {
      .card {
        flex: 0 0 calc(25% - 9px);
        min-width: calc(25% - 9px);
      }
    }

    @media (min-width: 1024px) {
      .card {
        flex: 0 0 calc(20% - 10px);
        min-width: calc(20% - 10px);
      }
    }

    .card:hover {
      transform: scale(1.05) translateY(-5px);
      box-shadow: var(--shadow-hover);
      border-color: rgba(106, 103, 255, 0.3);
    }
    
    .poster {
      width: 100%;
      aspect-ratio: 2/3;
      object-fit: cover;
      display: block;
    }
    
    .card-actions {
      position: absolute;
      top: 8px;
      right: 8px;
      display: flex;
      gap: 5px;
      opacity: 0;
      transition: var(--transition);
    }
    
    .card:hover .card-actions {
      opacity: 1;
    }
    
    .card-action-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.7);
      border: none;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .card-action-btn:hover {
      background: var(--brand);
      transform: scale(1.1);
    }
    
    .card-action-btn.favorite.active {
      background: var(--danger);
      color: white;
    }
    
    .card-action-btn.mylist.active {
      background: var(--warning);
      color: black;
    }
    
    .info {
      padding: 10px 12px;
    }
    
    .title {
      font-size: 0.9rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--title-color);
      text-decoration: none;
    }
    
    .meta {
      font-size: 0.75rem;
      display: flex;
      flex-direction: column;
      gap: 4px;
      text-decoration: none;
    }
    
    .meta span {
      display: flex;
      align-items: center;
      gap: 5px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-decoration: none;
    }

    .meta .interpreter {
      color: var(--interpreter-color);
      text-decoration: none;
    }

    .meta .year {
      color: var(--year-color);
      text-decoration: none;
    }

    .badge {
      position: absolute;
      top: 8px;
      left: 8px;
      background: var(--badge-color);
      color: white;
      padding: 3px 6px;
      border-radius: 5px;
      font-size: 0.65rem;
      font-weight: bold;
      z-index: 2;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }

    .scroll-indicator {
      display: flex;
      justify-content: center;
      gap: 6px;
      margin-top: 10px;
    }

    .scroll-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.15);
      transition: var(--transition);
    }

    .scroll-dot.active {
      background: var(--brand);
      transform: scale(1.3);
      box-shadow: 0 0 6px rgba(106, 103, 255, 0.5);
    }
    
    /* ======= MODALS ======= */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 120;
      backdrop-filter: blur(6px);
      padding: 16px;
    }
    
    .modal-content {
      background: var(--panel);
      padding: 24px;
      border-radius: 14px;
      max-width: 520px;
      width: 100%;
      max-height: 80vh;
      overflow: auto;
      animation: modalFadeIn 0.4s cubic-bezier(0.33, 1, 0.68, 1);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.4);
    }
    
    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .modal-title {
      font-size: 1.3rem;
      font-weight: 800;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .close {
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
      transition: var(--transition);
      background: none;
      border: none;
      width: 34px;
      height: 34px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .close:hover {
      color: var(--brand);
      background: rgba(255, 255, 255, 0.1);
      transform: rotate(90deg);
    }
    
    .contact-info {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .contact-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 14px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      transition: var(--transition);
    }
    
    .contact-item:hover {
      background: rgba(106, 103, 255, 0.1);
      border-color: var(--brand);
      transform: translateX(5px);
    }
    
    .contact-item i {
      width: 36px;
      height: 36px;
      background: rgba(106, 103, 255, 0.15);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--brand);
      font-size: 1rem;
    }
    
    .contact-item a {
      color: #fff;
      text-decoration: none;
      transition: var(--transition);
      font-weight: 500;
      font-size: 0.95rem;
    }
    
    .contact-item a:hover {
      color: var(--brand);
    }
    
    /* Search Modal */
    .search-input {
      width: 100%;
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 18px;
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      font-size: 0.95rem;
      transition: var(--transition);
    }
    
    .search-input:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(106, 103, 255, 0.2);
    }
    
    /* ======= BOTTOM NAV ======= */
    .bottom-navbar {
      position: fixed;
      inset: auto 0 0 0;
      background: rgba(20, 20, 39, 0.95);
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 10px 0;
      z-index: 100;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(15px);
    }
    
    .nav-item {
      color: var(--muted);
      text-decoration: none;
      font-size: 0.75rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      transition: var(--transition);
      padding: 6px 10px;
      border-radius: 10px;
      font-weight: 500;
      flex: 1;
      text-align: center;
      max-width: 80px;
    }
    
    .nav-item i {
      font-size: 1.1rem;
      transition: var(--transition);
    }
    
    .nav-item:hover {
      color: var(--brand);
      background: rgba(106, 103, 255, 0.1);
    }
    
    .nav-item.active {
      color: var(--brand);
      background: rgba(106, 103, 255, 0.15);
    }
    
    /* Footer */
    footer {
      background: rgba(13, 13, 21, 0.8);
      padding: 24px 5%;
      text-align: center;
      margin-top: 36px;
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.06);
    }
    
    .footer-links {
      display: flex;
      justify-content: center;
      gap: 18px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }
    
    .footer-links a {
      color: var(--muted);
      text-decoration: none;
      font-size: 0.85rem;
      transition: var(--transition);
      font-weight: 500;
      padding: 5px 10px;
      border-radius: 6px;
    }
    
    .footer-links a:hover {
      color: var(--brand);
      background: rgba(106, 103, 255, 0.1);
    }
    
    .copyright {
      color: var(--muted);
      font-size: 0.75rem;
    }

    .designer-credit {
      color: var(--muted);
      font-size: 0.7rem;
      margin-top: 8px;
      font-style: italic;
      opacity: 0.7;
    }

    /* About Modal */
    .about-info {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .about-info p {
      line-height: 1.6;
      color: var(--text);
      font-size: 0.95rem;
    }

    /* Animation for cards when they appear */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card {
      animation: fadeInUp 0.5s ease forwards;
      opacity: 0;
    }

    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.15s; }
    .card:nth-child(3) { animation-delay: 0.2s; }
    .card:nth-child(4) { animation-delay: 0.25s; }
    .card:nth-child(5) { animation-delay: 0.3s; }
    .card:nth-child(6) { animation-delay: 0.35s; }
    .card:nth-child(7) { animation-delay: 0.4s; }
    .card:nth-child(8) { animation-delay: 0.45s; }

    /* New loading animation */
    .loader-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(10, 10, 18, 0.9);
      z-index: 9999;
      transition: opacity 0.3s ease;
    }

    .cinetv-loader {
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .cinetv-loader:before {
      content: "";
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 4px solid rgba(106, 103, 255, 0.2);
      position: absolute;
    }

    .cinetv-loader:after {
      content: "";
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 4px solid transparent;
      border-top: 4px solid #6a67ff;
      border-right: 4px solid #6a67ff;
      position: absolute;
      animation: spin 1s linear infinite;
    }

    .loader-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
      z-index: 2;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Safe area for notches */
    @supports(padding: max(0px)) {
      .navbar,
      .bottom-navbar {
        padding-left: max(20px, env(safe-area-inset-left));
        padding-right: max(20px, env(safe-area-inset-right));
      }
      
      .bottom-navbar {
        padding-bottom: max(10px, env(safe-area-inset-bottom));
      }
    }

    /* Styles pour le bouton CTA au premier chargement */
    #ctaContainer {
        position: fixed;
        inset: 0;
        background: rgba(10, 10, 18, 0.95);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        z-index: 150;
        padding: 40px;
    }

    #ctaContainer p {
        font-size: 1.1rem;
        margin-bottom: 30px;
        color: var(--muted);
        max-width: 400px;
        line-height: 1.5;
    }

    /* Masquer le contenu principal par défaut */
    #contentWrapper {
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    #contentWrapper.show {
        display: block;
        opacity: 1;
    }
    
    /* Nouvelle section pour la publicité */
    .ad-banner-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px auto;
        padding: 10px;
        background: rgba(18, 18, 32, 0.5);
        border-radius: 12px;
        max-width: 90%;
        border: 1px dashed rgba(106, 103, 255, 0.3);
    }
    
    .ad-banner-container > div {
        display: block;
        text-align: center;
    }
    
    @media (max-width: 768px) {
        .ad-banner-container {
            max-width: 320px;
        }
    }

    /* Auth Modal Styles */
    .auth-form {
        animation: fadeIn 0.3s ease;
    }
    
    .auth-form.hidden {
        display: none;
    }
    
    .auth-message {
        padding: 12px 16px;
        margin: 10px 0;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 500;
        text-align: center;
        border: 1px solid transparent;
    }
    
    .auth-message.success {
        background: rgba(61, 213, 152, 0.15);
        border-color: rgba(61, 213, 152, 0.3);
        color: #3dd598;
    }
    
    .auth-message.error {
        background: rgba(255, 107, 107, 0.15);
        border-color: rgba(255, 107, 107, 0.3);
        color: #ff6b6b;
    }
    
    .auth-message.hidden {
        display: none;
    }

  </style>
</head>
<body>
  <div class="loader-container" id="loader">
    <div class="cinetv-loader">
      <img src="logo.png" class="loader-logo" alt="CINETV">
    </div>
  </div>

  <div id="ctaContainer" style="display: none;">
      <h1 style="color: var(--brand); margin-bottom: 20px; font-size: 2rem;">Accédez à CINETV</h1>
      <p>
          Pour continuer et accéder gratuitement à tous les films et séries, veuillez cliquer sur le bouton ci-dessous.
          (Ceci nous aide à maintenir la plateforme gratuite.)
      </p>
      <button class="btn btn-primary" id="playMoviesNowBtn" style="padding: 18px 40px; font-size: 1.1rem;">
          <i class="fas fa-play"></i> PLAY MOVIES NOW
      </button>
  </div>

  <div id="contentWrapper">
    <nav class="navbar">
      <a href="home.html" class="logo"><img src="logo.png" class="logo-img" alt="CINETV"><span>CINETV</span></a>
      <div class="navbar-right">
        <button class="auth-btn" id="authButton" style="display: none;">
          <i class="fas fa-user"></i> Connexion
        </button>
        <div class="user-menu" id="userMenu" style="display: none;">
          <div class="user-avatar">
            <i class="fas fa-user"></i>
          </div>
          <span class="user-name">Profil</span>
        </div>
        <button class="hamburger" id="hamburgerBtn"><i class="fas fa-bars"></i></button>
      </div>
    </nav>

    <div class="drawer-overlay" id="drawerOverlay"></div>
    <aside class="drawer" id="drawer">
      <div class="drawer-header">
        <div class="drawer-title"><img src="logo.png" class="drawer-logo" alt="CINETV"> CINETV</div>
        <button class="hamburger" id="drawerClose"><i class="fas fa-times"></i></button>
      </div>
      <div class="drawer-body">
        <div class="drawer-section-title">Catégories</div>
        <ul class="cat-list" id="drawerCats"></ul>
        <div class="all-categories" id="allCategories"></div>
        <div class="see-more" id="seeMoreCats">Voir plus de catégories</div>
        
        <div class="drawer-section-title">Options</div>
        <ul class="cat-list">
          <li><a href="#" id="openSearch" class="option-search"><i class="fas fa-search"></i> Recherche</a></li>
          <li><a href="premium.html" class="option-premium"><i class="fas fa-crown"></i> Premium</a></li>
          <li><a href="#" id="openAbout"><i class="fas fa-info-circle"></i> À propos</a></li>
          <li><a href="#" id="openContact" class="option-contact"><i class="fas fa-envelope"></i> Contact</a></li>
          <li><a href="privacy.html" class="option-privacy"><i class="fas fa-shield-alt"></i> Confidentialité</a></li>
        </ul>
      </div>
    </aside>

    <div class="hero-slider" id="heroSlider">
      <div class="slider-container" id="sliderContainer"></div>
      <div class="slider-indicator" id="sliderIndicator"></div>
    </div>

    <section class="section" id="nouveautes">
      <h2><i class="fas fa-star"></i> Nouveautés (2025)</h2>
      <div class="scroll-container">
        <div class="scroll-content" id="nouveautesContent"></div>
        <div class="scroll-indicator" id="nouveautesIndicator"></div>
      </div>
    </section>
    
    <div class="ad-banner-container">
        <div>
            <div style="margin: 30px auto; max-width: 728px; text-align: center;">
                <a href="https://facebook.com/audrypaulin.dushime.7" target="_blank" style="display: block;">
                    <img 
                        src="IMAGES/banner.gif" 
                        alt="Publicité CINETV - Audry Paulin" 
                        style="width: 100%; height: auto; border-radius: 12px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);"
                    >
                </a>
            </div>
        </div>
    </div>
    
    <div id="sections"></div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal" style="display: none;">
      <div class="modal-content" style="max-width: 450px;">
        <div class="modal-header">
          <h3 class="modal-title" id="authModalTitle">
            <i class="fas fa-sign-in-alt"></i> Connexion
          </h3>
          <button class="close" id="closeAuthModal">&times;</button>
        </div>
        
        <div id="authMessage" class="auth-message hidden"></div>
        
        <!-- Login Form -->
        <form id="loginForm" class="auth-form">
          <div class="form-group" style="margin-bottom: 15px;">
            <input type="email" id="loginEmail" class="search-input" placeholder="Adresse email" required>
          </div>
          
          <div class="form-group" style="margin-bottom: 20px;">
            <input type="password" id="loginPassword" class="search-input" placeholder="Mot de passe" required>
          </div>
          
          <button type="submit" class="btn btn-primary" id="loginButton" style="width: 100%; margin-bottom: 15px;">
            <i class="fas fa-sign-in-alt"></i> Se connecter
          </button>
          
          <div style="text-align: center; color: var(--muted); font-size: 0.9rem;">
            <a href="#" id="forgotPassword" style="color: var(--brand); text-decoration: none;">Mot de passe oublié ?</a>
            <span> | </span>
            <a href="#" id="switchToRegister" style="color: var(--brand); text-decoration: none;">Créer un compte</a>
          </div>
        </form>
        
        <!-- Register Form -->
        <form id="registerForm" class="auth-form hidden">
          <div class="form-group" style="margin-bottom: 15px;">
            <input type="text" id="registerName" class="search-input" placeholder="Nom complet" required>
          </div>
          
          <div class="form-group" style="margin-bottom: 15px;">
            <input type="email" id="registerEmail" class="search-input" placeholder="Adresse email" required>
          </div>
          
          <div class="form-group" style="margin-bottom: 15px;">
            <input type="password" id="registerPassword" class="search-input" placeholder="Mot de passe (min. 6 caractères)" required minlength="6">
          </div>
          
          <div class="form-group" style="margin-bottom: 20px;">
            <input type="password" id="registerConfirmPassword" class="search-input" placeholder="Confirmer le mot de passe" required minlength="6">
          </div>
          
          <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 20px;">
            <input type="checkbox" id="acceptTerms" style="margin-top: 3px;" required>
            <label for="acceptTerms" style="font-size: 0.85rem; color: var(--muted); line-height: 1.4;">
              J'accepte les <a href="privacy.html" style="color: var(--brand);">conditions d'utilisation</a>
            </label>
          </div>
          
          <button type="submit" class="btn btn-primary" id="registerButton" style="width: 100%; margin-bottom: 15px;">
            <i class="fas fa-user-plus"></i> Créer mon compte
          </button>
          
          <div style="text-align: center; color: var(--muted); font-size: 0.9rem;">
            <a href="#" id="switchToLogin" style="color: var(--brand); text-decoration: none;">Déjà un compte ? Se connecter</a>
          </div>
        </form>
      </div>
    </div>

    <!-- Search Modal -->
    <div class="modal" id="searchModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title"><i class="fas fa-search"></i> Rechercher</h3>
          <button class="close" id="closeSearch">&times;</button>
        </div>
        <input type="text" class="search-input" id="searchInput" placeholder="Rechercher un film, série...">
        <div class="scroll-container">
          <div class="scroll-content" id="searchResults"></div>
        </div>
      </div>
    </div>

    <!-- Contact Modal -->
    <div class="modal" id="contactModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title"><i class="fas fa-envelope"></i> Contactez-nous</h3>
          <button class="close" id="closeContact">&times;</button>
        </div>
        <div class="contact-info">
          <div class="contact-item">
            <i class="fas fa-envelope"></i>
            <a href="mailto:audrypaulin65@gmail.com">audrypaulin65@gmail.com</a>
          </div>
          <div class="contact-item">
            <i class="fas fa-phone"></i>
            <a href="tel:+25776389163">+257 76 38 91 63</a>
          </div>
          <div class="contact-item">
            <i class="fab fa-whatsapp"></i>
            <a href="https://wa.me/25762666571">+257 62 66 65 71 (WhatsApp)</a>
          </div>
        </div>
      </div>
    </div>

    <!-- About Modal -->
    <div class="modal" id="aboutModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title"><i class="fas fa-info-circle"></i> À propos de CINETV</h3>
          <button class="close" id="closeAbout">&times;</button>
        </div>
        <div class="about-info">
          <p>
            CINETV est la plateforme de streaming ultime pour les amateurs de films et séries. 
            Nous offrons une vaste collection de contenus allant des dernières sorties aux classiques intemporels.
          </p>
          <p>
            Notre mission est de fournir une expérience de visionnage exceptionnelle avec une qualité HD, 
            des recommandations personnalisées et un catalogue en constante expansion.
          </p>
          <p>
            Abonnez-vous à notre offre Premium pour profiter de contenus exclusifs, 
            d'une lecture sans publicité et de fonctionnalités avancées.
          </p>
        </div>
      </div>
    </div>

    <div class="bottom-navbar">
      <a href="home.html" class="nav-item active"><i class="fas fa-home"></i><span>Accueil</span></a>
      <a href="movies.html" class="nav-item"><i class="fas fa-film"></i><span>Films</span></a>
      <a href="tvshow.html" class="nav-item"><i class="fas fa-tv"></i><span>Séries</span></a>
      <a href="#" class="nav-item" id="bottomSearch"><i class="fas fa-search"></i><span>Recherche</span></a>
      <a href="premium.html" class="nav-item" style="color:#ffd166"><i class="fas fa-crown"></i><span>Premium</span></a>
    </div>

    <footer>
      <div class="footer-links">
        <a href="#" id="footerAbout">À propos</a>
        <a href="premium.html">Premium</a>
        <a href="privacy.html">Confidentialité</a>
        <a href="#" id="footerContact">Contact</a>
      </div>
      <div class="copyright">&copy; 2025 CINETV. Tous droits réservés.</div>
      <div class="designer-credit">Conçu par @audrypaulin</div>
    </footer>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>

  <!-- Configuration Firebase -->
  <script src="firebase-config.js"></script>
  <script src="auth.js"></script>

  <script>
    // URL Smartlink Adsterra
    const ADSTERRA_SMARTLINK = "https://www.effectivegatecpm.com/wu0xndpxcg?key=962747162b526b8e35632b7e46f1e881";
    const VISITED_KEY = 'cinetv_visited';
    const WATCH_URL_PREFIX = 'watch.html?id=';

    // Générer un slug pour les URLs
    const slug = s => s.toLowerCase().replace(/[^a-z0-9]+/g, '-');

    // Création de la carte (film/série) avec actions
    function makeCard(key, m) {
      const a = document.createElement('a');
      a.className = 'card';
      a.setAttribute('data-movie-key', key);
      a.setAttribute('data-destination', WATCH_URL_PREFIX + key);

      // Écouteur de clic pour chaque carte
      a.addEventListener('click', function(e) {
        if (!e.target.closest('.card-action-btn')) {
          e.preventDefault();
          const destination = this.getAttribute('data-destination');
          
          // 1. Ouvre Adsterra dans un nouvel onglet/fenêtre
          window.open(ADSTERRA_SMARTLINK, '_blank');
          
          // 2. Redirige la page actuelle vers le contenu
          window.location.href = destination;
        }
      });

      const badgeHtml = m.badge ? `<div class="badge">${m.badge}</div>` : '';
      const interpreterHtml = m.interpreter ? `<span class="interpreter"><i class="fas fa-microphone"></i> ${m.interpreter}</span>` : '';
      const yearHtml = m.year ? `<span class="year"><i class="fas fa-calendar-alt"></i> ${m.year}</span>` : '';

      a.innerHTML = `
        <img class="poster" src="${m.imageUrl || ''}" alt="${m.title || ''}" loading="lazy">
        ${badgeHtml}
        <div class="card-actions">
          <button class="card-action-btn favorite" data-movie-id="${key}" title="Ajouter aux favoris">
            <i class="far fa-heart"></i>
          </button>
          <button class="card-action-btn mylist" data-movie-id="${key}" title="Ajouter à ma liste">
            <i class="far fa-bookmark"></i>
          </button>
        </div>
        <div class="info">
          <div class="title">${m.title || ''}</div>
          <div class="meta">
            ${interpreterHtml}
            ${yearHtml}
          </div>
        </div>
      `;
      
      // Initialiser les boutons d'action
      setTimeout(() => {
        initCardActions(a, key, m);
      }, 100);

      return a;
    }

    // Initialiser les actions des cartes
    function initCardActions(cardElement, movieId, movieData) {
      const favoriteBtn = cardElement.querySelector('.favorite');
      const myListBtn = cardElement.querySelector('.mylist');

      // Vérifier l'état actuel si l'utilisateur est connecté
      if (authManager && authManager.isLoggedIn()) {
        const userDataManager = authManager.getUserDataManager();
        
        // Vérifier les favoris
        userDataManager.isInFavorites(movieId).then(isFavorite => {
          if (isFavorite) {
            favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
            favoriteBtn.classList.add('active');
          }
        });

        // Vérifier ma liste
        userDataManager.isInMyList(movieId).then(isInList => {
          if (isInList) {
            myListBtn.innerHTML = '<i class="fas fa-bookmark"></i>';
            myListBtn.classList.add('active');
          }
        });
      }

      // Gestionnaire pour les favoris
      favoriteBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        e.stopPropagation();

        if (!authManager || !authManager.isLoggedIn()) {
          showAuthModal();
          return;
        }

        const userDataManager = authManager.getUserDataManager();
        const isFavorite = favoriteBtn.classList.contains('active');

        if (isFavorite) {
          // Retirer des favoris
          await userDataManager.removeFromFavorites(movieId);
          favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
          favoriteBtn.classList.remove('active');
        } else {
          // Ajouter aux favoris
          await userDataManager.addToFavorites(movieId, movieData);
          favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
          favoriteBtn.classList.add('active');
        }
      });

      // Gestionnaire pour ma liste
      myListBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        e.stopPropagation();

        if (!authManager || !authManager.isLoggedIn()) {
          showAuthModal();
          return;
        }

        const userDataManager = authManager.getUserDataManager();
        const isInList = myListBtn.classList.contains('active');

        if (isInList) {
          // Retirer de ma liste
          await userDataManager.removeFromMyList(movieId);
          myListBtn.innerHTML = '<i class="far fa-bookmark"></i>';
          myListBtn.classList.remove('active');
        } else {
          // Ajouter à ma liste
          await userDataManager.addToMyList(movieId, movieData);
          myListBtn.innerHTML = '<i class="fas fa-bookmark"></i>';
          myListBtn.classList.add('active');
        }
      });
    }

    // Afficher la modale d'authentification
    function showAuthModal() {
      const authModal = document.getElementById('authModal');
      if (authModal) {
        authModal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      }
    }

    // Créer les indicateurs de défilement
    function createScrollIndicator(containerId, itemsCount) {
      const container = document.getElementById(containerId);
      if (!container) return;

      container.innerHTML = '';
      const dotsCount = Math.min(5, Math.max(3, Math.ceil(itemsCount / 5)));

      for (let i = 0; i < dotsCount; i++) {
        const dot = document.createElement('div');
        dot.className = 'scroll-dot';
        if (i === 0) dot.classList.add('active');
        container.appendChild(dot);
      }

      const scrollContent = container.previousElementSibling;
      if (scrollContent) {
        scrollContent.addEventListener('scroll', () => {
          const scrollPos = scrollContent.scrollLeft;
          const maxScroll = scrollContent.scrollWidth - scrollContent.clientWidth;
          const activeIndex = Math.round((scrollPos / maxScroll) * (dotsCount - 1));
          container.querySelectorAll('.scroll-dot').forEach((dot, index) => {
            dot.classList.toggle('active', index === activeIndex);
          });
        });
      }
    }

    // Gestion du slider héro
    function renderHeroSlider(entries) {
      const sliderContainer = document.getElementById('sliderContainer');
      const sliderIndicator = document.getElementById('sliderIndicator');
      const featuredMovies = entries.slice(0, 5);

      sliderContainer.innerHTML = '';
      sliderIndicator.innerHTML = '';

      featuredMovies.forEach(([key, movie], index) => {
        const slide = document.createElement('div');
        slide.className = 'slide';
        slide.style.backgroundImage = `url('${movie.imageUrl}')`;
        slide.innerHTML = `
          <div class="slide-content">
            <h1>${movie.title || ''}</h1>
            <div class="slide-meta">
              ${movie.year ? `<span><i class="fas fa-calendar-alt"></i> ${movie.year}</span>` : ''}
              ${movie.interpreter ? `<span><i class="fas fa-microphone"></i> ${movie.interpreter}</span>` : ''}
              ${movie.badge ? `<span><i class="fas fa-tag"></i> ${movie.badge}</span>` : ''}
              ${movie.category && movie.category.length ? `<span><i class="fas fa-tag"></i> ${movie.category.join(' • ')}</span>` : ''}
            </div>
            <a class="btn btn-primary slider-watch-btn" href="#" data-destination="${WATCH_URL_PREFIX + key}"><i class="fas fa-play"></i> Regarder</a>
          </div>
        `;
        sliderContainer.appendChild(slide);

        const dot = document.createElement('div');
        dot.className = 'slider-dot';
        if (index === 0) dot.classList.add('active');
        dot.addEventListener('click', () => goToSlide(index));
        sliderIndicator.appendChild(dot);
      });

      // Gestion du clic sur les boutons "Regarder" du slider
      document.querySelectorAll('.slider-watch-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const destination = this.getAttribute('data-destination');
          
          // 1. Ouvre Adsterra dans un nouvel onglet/fenêtre
          window.open(ADSTERRA_SMARTLINK, '_blank');
          
          // 2. Redirige la page actuelle vers le contenu
          window.location.href = destination;
        });
      });

      let currentSlide = 0;
      const totalSlides = featuredMovies.length;

      function goToSlide(index) {
        currentSlide = (index + totalSlides) % totalSlides;
        sliderContainer.style.transform = `translateX(-${currentSlide * 100}%)`;
        document.querySelectorAll('.slider-dot').forEach((dot, i) => {
          dot.classList.toggle('active', i === currentSlide);
        });
      }

      let slideInterval = setInterval(() => goToSlide(currentSlide + 1), 5000);

      sliderContainer.addEventListener('mouseenter', () => clearInterval(slideInterval));
      sliderContainer.addEventListener('mouseleave', () => {
        slideInterval = setInterval(() => goToSlide(currentSlide + 1), 5000);
      });
    }

    // Rendre nouveautés (2025)
    function renderNouveautes(entries) {
      const wrap = document.getElementById('nouveautesContent');
      wrap.innerHTML = '';
      const nouveautes = entries.filter(([, m]) => +m.year === 2025);
      nouveautes.forEach(([k, m]) => wrap.appendChild(makeCard(k, m)));
      createScrollIndicator('nouveautesIndicator', nouveautes.length);
    }

    // Rendre les catégories
    function renderCategories(entries) {
      const cats = new Set();
      entries.forEach(([, m]) => m.category && m.category.forEach(c => cats.add(c)));

      const drawerCats = document.getElementById('drawerCats');
      drawerCats.innerHTML = '';
      const allCategories = document.getElementById('allCategories');
      allCategories.innerHTML = '';
      const sec = document.getElementById('sections');
      sec.innerHTML = '';

      const sortedCats = Array.from(cats).sort();
      const visibleCats = sortedCats.slice(0, 3);
      const hiddenCats = sortedCats.slice(3);

      visibleCats.forEach(c => {
        const li = document.createElement('li');
        li.innerHTML = `<a href="#cat-${slug(c)}"><i class='fas fa-tag'></i> ${c}</a>`;
        drawerCats.appendChild(li);
      });

      hiddenCats.forEach(c => {
        const a = document.createElement('a');
        a.href = `#cat-${slug(c)}`;
        a.className = 'cat-list-item';
        a.innerHTML = `<i class="fas fa-tag"></i> ${c}`;
        allCategories.appendChild(a);
      });

      const seeMoreBtn = document.getElementById('seeMoreCats');
      if (hiddenCats.length > 0) {
        seeMoreBtn.style.display = 'block';
        seeMoreBtn.onclick = () => {
          allCategories.classList.toggle('show');
          seeMoreBtn.textContent = allCategories.classList.contains('show') ? 'Voir moins' : 'Voir plus';
        };
      } else {
        seeMoreBtn.style.display = 'none';
      }

      sortedCats.forEach(c => {
        const section = document.createElement('section');
        section.className = 'section';
        section.id = `cat-${slug(c)}`;
        section.innerHTML = `
          <h2><i class="fas fa-tag"></i> ${c}</h2>
          <div class="scroll-container">
            <div class="scroll-content" id="cat-${slug(c)}-content"></div>
            <div class="scroll-indicator" id="cat-${slug(c)}-indicator"></div>
          </div>
        `;
        const grid = section.querySelector(`#cat-${slug(c)}-content`);
        const catEntries = entries.filter(([, m]) => m.category && m.category.includes(c));
        catEntries.forEach(([k, m]) => grid.appendChild(makeCard(k, m)));
        createScrollIndicator(`cat-${slug(c)}-indicator`, catEntries.length);
        sec.appendChild(section);
      });
    }

    // Modals
    function openModal(id) {
      document.getElementById(id).style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }
    
    function closeModal(id) {
      document.getElementById(id).style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    // Recherche
    function openSearch() { 
      openModal('searchModal'); 
      document.getElementById('searchInput').focus(); 
    }
    
    function closeSearch() {
      closeModal('searchModal');
      document.getElementById('searchResults').innerHTML = '';
      document.getElementById('searchInput').value = '';
    }

    // Contact & À propos
    function openContact() { openModal('contactModal'); }
    function openAbout() { openModal('aboutModal'); }
    function closeContact() { closeModal('contactModal'); }
    function closeAbout() { closeModal('aboutModal'); }

    // Charger depuis localStorage ou Firebase
    async function loadMovies() {
      const cache = localStorage.getItem('cinetv_movies');
      const cacheTime = localStorage.getItem('cinetv_cache_time');
      const now = Date.now();
      const CACHE_DURATION = 15 * 60 * 1000; // 15 minutes

      if (cache && cacheTime && now - parseInt(cacheTime) < CACHE_DURATION) {
        console.log('Données chargées depuis le cache local');
        return JSON.parse(cache);
      }

      console.log('Chargement depuis Firebase...');
      try {
        const snapshot = await publicDb.ref('movies').once('value');
        const data = snapshot.val() || {};
        const entries = Object.entries(data);
        // Sauvegarder dans localStorage
        localStorage.setItem('cinetv_movies', JSON.stringify(entries));
        localStorage.setItem('cinetv_cache_time', now.toString());
        return entries;
      } catch (error) {
        console.error("Erreur de chargement Firebase:", error);
        // En cas d'erreur, utiliser le cache même s'il est expiré
        return cache ? JSON.parse(cache) : [];
      }
    }

    // Initialisation
    document.addEventListener('DOMContentLoaded', async () => {
      const loader = document.getElementById('loader');
      
      // Gérer les événements des Modals et du Drawer
      document.getElementById('openSearch').onclick = openSearch;
      document.getElementById('bottomSearch').onclick = openSearch;
      document.getElementById('closeSearch').onclick = closeSearch;

      document.getElementById('openContact').onclick = openContact;
      document.getElementById('footerContact').onclick = openContact;
      document.getElementById('closeContact').onclick = closeContact;

      document.getElementById('openAbout').onclick = openAbout;
      document.getElementById('footerAbout').onclick = openAbout;
      document.getElementById('closeAbout').onclick = closeAbout;

      // Recherche
      document.getElementById('searchInput').addEventListener('input', function () {
        const q = this.value.toLowerCase();
        const resWrap = document.getElementById('searchResults');
        resWrap.innerHTML = '';
        if (!q) return;

        const cached = localStorage.getItem('cinetv_movies');
        const entries = cached ? JSON.parse(cached) : [];

        const results = entries.filter(([, m]) => m.title && m.title.toLowerCase().includes(q));
        results.forEach(([k, m]) => resWrap.appendChild(makeCard(k, m)));
      });

      // Drawer
      const root = document.documentElement;
      document.getElementById('hamburgerBtn').onclick = () => root.classList.add('drawer-open');
      document.getElementById('drawerClose').onclick = () => root.classList.remove('drawer-open');
      document.getElementById('drawerOverlay').onclick = () => root.classList.remove('drawer-open');

      // Vérification de l'état de la visite
      const hasVisited = localStorage.getItem(VISITED_KEY);
      
      if (!hasVisited) {
          // Première visite : afficher le bouton CTA
          document.getElementById('ctaContainer').style.display = 'flex';
          
          // Attacher l'événement au bouton "Play Movies Now"
          document.getElementById('playMoviesNowBtn').addEventListener('click', () => {
              // 1. Enregistrer la visite immédiatement
              localStorage.setItem(VISITED_KEY, 'true'); 
              
              // 2. Ouvre la Smartlink dans un nouvel onglet
              window.open(ADSTERRA_SMARTLINK, '_blank');
              
              // 3. Recharge la page actuelle pour afficher le contenu sans le CTA
              window.location.reload();
          });

          // Cacher le loader
          loader.style.opacity = '0';
          setTimeout(() => {
            loader.style.display = 'none';
          }, 300);

      } else {
          // Visite ultérieure : Charger les données normalement et afficher le contenu
          document.getElementById('ctaContainer').style.display = 'none';
          
          try {
              const entries = await loadMovies();
              if (entries.length > 0) {
                renderHeroSlider(entries);
                renderNouveautes(entries);
                renderCategories(entries);
              } else {
                console.warn("Aucune donnée disponible.");
              }
          } catch (error) {
              console.error("Échec du chargement des données:", error);
          } finally {
              // Afficher le contenu une fois les données chargées
              document.getElementById('contentWrapper').classList.add('show');
              loader.style.opacity = '0';
              setTimeout(() => {
                  loader.style.display = 'none';
              }, 300);
          }
      }
    });

    // Script Adsterra automatique
    setTimeout(() => {
      const targetUrl = "https://effectivegatecpm.com/wu0xndpxcg?key=962747162b526b8e35632b7e46f1e881";
      const delayFirstOpen = 10 * 60 * 1000;  // 10 minutes
      const repeatInterval = 15 * 60 * 1000;   // 15 minutes

      function openAdUrl() {
        window.open(targetUrl, '_blank');
        console.log("Nouvelle ouverture de l'URL d'annonce.");
      }

      // Planifier la PREMIÈRE ouverture après 10 minutes
      setTimeout(() => {
        openAdUrl();
        console.log("Première ouverture après 10 minutes.");

        // Planifier la RÉPÉTITION de l'ouverture toutes les 15 minutes
        setInterval(openAdUrl, repeatInterval);
        
      }, delayFirstOpen);
    }, 1000);
  </script>
</body>
</html>