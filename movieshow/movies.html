<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Movies - MovieShow</title>
  <link rel="icon" href="logo.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRSJ4J6W6P"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DRSJ4J6W6P');
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    :root {
      --bg: #000000;
      --panel: #111111;
      --panel-2: #222222;
      --text: #ffffff;
      --text-secondary: #f0f0f0;
      --muted: #cccccc;
      --brand: #03C771;
      --brand-light: #34d187;
      --brand-dark: #02a55c;
      --action: #03C771;
      --transition: all 0.3s ease;
      --gradient: linear-gradient(135deg, #03C771 0%, #02a55c 100%);
      --white-element: #ffffff;
      --premium-color: #ffd700;
    }
    
    body {
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 70px;
    }

    /* ======= NAVBAR ======= */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 55px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      padding: 0 15px;
      background: #000000;
      border-bottom: 1px solid #333333;
    }
    
    .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .logo-img {
      width: 160px;
      height: 160px;
      object-fit: contain;
      filter: drop-shadow(0 0 10px rgba(3, 199, 113, 0.7));
    }
    
    /* ======= MAIN CONTENT ======= */
    .main-container {
      padding: 65px 4% 20px;
      min-height: calc(100vh - 70px);
    }

    /* ======= SEARCH & FILTER SECTION ======= */
    .search-section {
      margin-bottom: 25px;
    }

    .search-title {
      font-size: 1.3rem;
      text-align: center;
      margin-bottom: 15px;
      color: var(--brand);
      font-weight: 700;
    }

    .search-container {
      background: #111111;
      border-radius: 10px;
      padding: 15px;
      border: 1px solid #333333;
      margin-bottom: 15px;
    }

    .search-input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .search-input {
      flex: 1;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #333333;
      background: #222222;
      color: var(--white-element);
      font-size: 0.9rem;
      transition: var(--transition);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 2px rgba(3, 199, 113, 0.2);
    }

    .search-btn {
      padding: 12px 20px;
      background: var(--gradient);
      color: var(--white-element);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .search-btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .apply-filters-btn {
      padding: 12px 20px;
      background: #222222;
      color: var(--white-element);
      border: 1px solid #444;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      justify-content: center;
      margin-top: 15px;
    }

    .apply-filters-btn:hover {
      background: rgba(3, 199, 113, 0.1);
      border-color: var(--brand);
      color: var(--brand);
    }

    .filters-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
      margin-top: 15px;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-label {
      font-size: 0.85rem;
      color: var(--white-element);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-label i {
      color: var(--brand);
    }

    .filter-select {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #333333;
      background: #222222;
      color: var(--white-element);
      font-size: 0.85rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--brand);
    }

    .filter-option {
      background: #222222;
      color: var(--white-element);
    }

    .active-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
      padding: 10px;
      background: rgba(3, 199, 113, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(3, 199, 113, 0.2);
      min-height: 50px;
      align-items: center;
    }

    .no-filters {
      color: var(--muted);
      font-size: 0.85rem;
      font-style: italic;
    }

    .filter-chip {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(3, 199, 113, 0.1);
      border-radius: 20px;
      font-size: 0.8rem;
      color: var(--brand);
    }

    .filter-chip i {
      cursor: pointer;
      font-size: 0.9rem;
      transition: var(--transition);
      color: var(--white-element);
    }

    .filter-chip i.fa-times:hover {
      color: var(--brand);
      transform: scale(1.1);
    }

    .clear-filters {
      padding: 8px 15px;
      background: transparent;
      border: 1px solid #333333;
      color: var(--muted);
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85rem;
      margin-top: 10px;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: center;
      width: 100%;
    }

    .clear-filters:hover {
      border-color: var(--brand);
      color: var(--brand);
    }

    .results-info {
      margin-top: 15px;
      padding: 10px;
      background: rgba(3, 199, 113, 0.05);
      border-radius: 8px;
      text-align: center;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .results-count {
      color: var(--brand);
      font-weight: 600;
    }

    .realtime-indicator {
      font-size: 0.75rem;
      color: var(--brand);
      margin-top: 5px;
      display: flex;
      align-items: center;
      gap: 5px;
      justify-content: center;
    }

    .realtime-indicator i {
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* ======= MOVIES GRID ======= */
    .movies-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .movies-grid {
        grid-template-columns: repeat(4, 1fr);
      }
      
      .filters-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      .movies-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }
      
      .filters-container {
        grid-template-columns: 1fr;
      }
      
      .search-input-group {
        flex-direction: column;
      }
    }

    .movie-card {
      position: relative;
      background: #222222;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      aspect-ratio: 2/3;
      border: 1px solid #333333;
      animation: fadeInUp 0.5s ease forwards;
      opacity: 0;
    }

    .movie-card:hover {
      transform: scale(1.03);
      border-color: var(--brand);
      box-shadow: 0 5px 15px rgba(3, 199, 113, 0.2);
    }
    
    .movie-poster {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      position: relative;
      z-index: 0;
    }
    
    .movie-card-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
      color: var(--white-element);
      z-index: 2;
    }
    
    .movie-card-title {
      font-size: 0.8rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--white-element);
    }
    
    .movie-card-meta {
      font-size: 0.7rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
    }

    .badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--brand);
      color: var(--white-element);
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 0.65rem;
      font-weight: bold;
      z-index: 2;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    /* Premium badge */
    .premium-badge {
      position: absolute;
      top: 8px;
      left: 8px;
      background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
      color: #000;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.6rem;
      font-weight: bold;
      z-index: 2;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    /* Animation for cards */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .movie-card:nth-child(1) { animation-delay: 0.1s; }
    .movie-card:nth-child(2) { animation-delay: 0.15s; }
    .movie-card:nth-child(3) { animation-delay: 0.2s; }
    .movie-card:nth-child(4) { animation-delay: 0.25s; }

    /* ======= LOADING & EMPTY STATES ======= */
    .loading-dots {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 40px 0;
    }
    
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: var(--brand);
      animation: bounce 1.4s infinite ease-in-out both;
    }
    
    .dot:nth-child(1) { animation-delay: -0.32s; }
    .dot:nth-child(2) { animation-delay: -0.16s; }
    
    @keyframes bounce {
      0%, 80%, 100% { 
        transform: scale(0);
        opacity: 0.5;
      }
      40% { 
        transform: scale(1);
        opacity: 1;
      }
    }
    
    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
      font-size: 1rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      border: 1px solid #333333;
      margin: 20px 0;
    }
    
    .no-results i {
      font-size: 3rem;
      margin-bottom: 15px;
      color: var(--brand);
      opacity: 0.5;
    }

    /* ======= PAGINATION ======= */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 30px;
      padding: 15px;
    }

    .page-btn {
      width: 35px;
      height: 35px;
      border-radius: 6px;
      border: 1px solid #333333;
      background: #222222;
      color: var(--white-element);
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .page-btn:hover {
      border-color: var(--brand);
      color: var(--brand);
    }

    .page-btn.active {
      background: var(--gradient);
      border-color: var(--brand);
      color: var(--white-element);
    }

    .page-btn.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ======= BOTTOM NAV ======= */
    .bottom-navbar {
      position: fixed;
      inset: auto 0 0 0;
      background: #000000;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 8px 0;
      z-index: 100;
      border-top: 1px solid #333333;
    }
    
    .nav-item {
      color: var(--white-element);
      text-decoration: none;
      font-size: 0.7rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      transition: var(--transition);
      padding: 6px 10px;
      border-radius: 8px;
      font-weight: 500;
      flex: 1;
      text-align: center;
      max-width: 70px;
    }
    
    .nav-item i {
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .nav-item:hover {
      color: var(--brand);
      background: rgba(3, 199, 113, 0.1);
    }
    
    .nav-item.active {
      color: var(--brand);
      background: rgba(3, 199, 113, 0.1);
    }

    /* Dropdown Menu */
    .nav-menu {
      position: relative;
    }

    .dropdown-menu {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      background: #111111;
      border-radius: 8px;
      padding: 8px;
      min-width: 160px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
      border: 1px solid #333333;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      margin-bottom: 8px;
      z-index: 101;
    }

    .nav-menu:hover .dropdown-menu {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(-50%) translateY(0);
    }

    .dropdown-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      color: var(--white-element);
      text-decoration: none;
      border-radius: 6px;
      transition: var(--transition);
      font-size: 0.85rem;
      white-space: nowrap;
    }

    .dropdown-item:hover {
      background: rgba(3, 199, 113, 0.1);
      color: var(--brand);
    }

    .premium-item {
      color: var(--premium-color) !important;
    }

    /* ======= FOOTER ======= */
    footer {
      background: #000000;
      padding: 25px 4%;
      text-align: center;
      margin-top: 40px;
      border-top: 1px solid #333333;
    }

    .footer-logo {
      width: 110px;
      height: 20px;
      margin: 0 auto 15px;
      display: block;
      filter: drop-shadow(0 0 8px rgba(3, 199, 113, 0.5));
    }

    .footer-social {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 15px 0;
    }

    .social-link {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: #222222;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white-element);
      font-size: 1.1rem;
      transition: var(--transition);
      text-decoration: none;
      border: 1px solid #333333;
    }

    .social-link:hover {
      background: var(--brand);
      color: var(--white-element);
      transform: translateY(-2px);
    }

    .footer-bio {
      max-width: 500px;
      margin: 15px auto;
      color: var(--white-element);
      line-height: 1.5;
      font-size: 0.8rem;
      opacity: 0.9;
    }

    .copyright {
      color: var(--white-element);
      font-size: 0.75rem;
      margin-top: 15px;
      opacity: 0.8;
    }

    .designer-credit {
      color: var(--brand);
      font-size: 0.7rem;
      margin-top: 8px;
      font-style: italic;
    }

    /* ======= ADS CONTAINER ======= */
    .ad-container {
      margin: 20px auto;
      padding: 0;
      background: transparent;
      border-radius: 8px;
      text-align: center;
      max-width: 728px;
      overflow: hidden;
      border: 1px solid #333333;
    }

    .ad-banner {
      width: 100%;
      height: auto;
      border-radius: 8px;
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <!-- Top Navbar -->
  <nav class="navbar">
    <div class="logo-container">
      <img src="logo.png" class="logo-img" alt="MovieShow">
    </div>
  </nav>
  
  <!-- Main Content -->
  <div class="main-container">
    <!-- Ad Banner -->
    <div class="ad-container">
      <a href="https://facebook.com/audrypaulin.dushime.7" target="_blank">.9.
        <img src="banner2.gif" alt="MovieShow Banner Ad" class="ad-banner">
      </a>
    </div>

    <!-- Search & Filter Section -->
    <section class="search-section">
      <h1 class="search-title"><i class="fas fa-search white-text"></i> Advanced Movie Search</h1>
      
      <div class="search-container">
        <div class="search-input-group">
          <input type="text" 
                 class="search-input" 
                 id="searchInput" 
                 placeholder="Search by title, interpreter, description...">
          <button class="search-btn" id="searchButton">
            <i class="fas fa-search"></i> Search
          </button>
        </div>
        
        <div class="filters-container">
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-calendar-alt"></i> Year</label>
            <select class="filter-select" id="yearFilter">
              <option value="">All Years</option>
              <!-- Will be populated by JavaScript -->
            </select>
          </div>
          
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-tags"></i> Category</label>
            <select class="filter-select" id="categoryFilter">
              <option value="">All Categories</option>
              <!-- Will be populated by JavaScript -->
            </select>
          </div>
          
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-microphone"></i> Interpreter</label>
            <select class="filter-select" id="interpreterFilter">
              <option value="">All Interpreters</option>
              <!-- Will be populated by JavaScript -->
            </select>
          </div>
          
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-star"></i> Sort By</label>
            <select class="filter-select" id="sortFilter">
              <option value="title_asc">Title (A-Z)</option>
              <option value="title_desc">Title (Z-A)</option>
              <option value="year_desc">Year (Newest)</option>
              <option value="year_asc">Year (Oldest)</option>
              <option value="latest">Latest Added</option>
            </select>
          </div>
        </div>
        
        <button class="apply-filters-btn" id="applyFilters">
          <i class="fas fa-check-circle"></i> Apply Filters
        </button>
        
        <div class="active-filters" id="activeFilters">
          <div class="no-filters">No filters applied</div>
        </div>
        
        <button class="clear-filters" id="clearFilters">
          <i class="fas fa-times"></i> Clear All Filters
        </button>
      </div>
      
      <div class="results-info" id="resultsInfo">
        <div>
          Showing <span class="results-count" id="resultsCount">0</span> movies
          <div class="realtime-indicator" id="realtimeIndicator">
            <i class="fas fa-bolt"></i> Real-time Search
          </div>
        </div>
      </div>
    </section>

    <!-- Ad Banner -->
    <div class="ad-container">
      <a href="https://facebook.com/audrypaulin.dushime.7" target="_blank">
        <img src="banner3.gif" alt="MovieShow Banner Ad" class="ad-banner">
      </a>
    </section>
    
    <!-- Movies Grid -->
    <div class="loading-dots" id="loadingSpinner">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    
    <div id="moviesGrid" class="movies-grid"></div>
    
    <div class="no-results" id="noResults" style="display: none;">
      <i class="fas fa-film"></i>
      <h3>No movies found</h3>
      <p>Try adjusting your search criteria or filters</p>
    </div>
    
    <!-- Pagination -->
    <div class="pagination" id="pagination" style="display: none;">
      <!-- Pagination buttons will be added here -->
    </div>

    <!-- Ad Banner -->
    <div class="ad-container">
      <a href="https://facebook.com/audrypaulin.dushime.7" target="_blank">
        <img src="banner.gif" alt="MovieShow Banner Ad" class="ad-banner">
      </a>
    </div>
  </div>
  
  <!-- Footer -->
  <footer>
    <img src="logo.png" class="footer-logo" alt="MovieShow">
    
    <div class="footer-social">
      <a href="https://facebook.com/audrypaulin.dushime.7" class="social-link" target="_blank">
        <i class="fab fa-facebook-f"></i>
      </a>
      <a href="https://wa.me/25776389163" class="social-link" target="_blank">
        <i class="fab fa-whatsapp"></i>
      </a>
      <a href="mailto:support@movieshow.com" class="social-link">
        <i class="fas fa-envelope"></i>
      </a>
    </div>

    <div class="footer-bio">
      MovieShow is your ultimate streaming platform for movies and TV series. 
      Enjoy unlimited entertainment with our constantly updated library. 
      Stream anytime, anywhere on any device.
    </div>

    <div class="copyright">
      &copy; 2025 MovieShow. All rights reserved.
    </div>
    <div class="designer-credit">
      Designed by @audrypaulin
    </div>
  </footer>

  <!-- Bottom Nav -->
  <div class="bottom-navbar">
    <a href="home.html" class="nav-item"><i class="fas fa-home"></i><span>Home</span></a>
    <a href="movies.html" class="nav-item active"><i class="fas fa-film"></i><span>Movies</span></a>
    <a href="tvshow.html" class="nav-item"><i class="fas fa-tv"></i><span>Series</span></a>
    <a href="#" class="nav-item" id="bottomSearch"><i class="fas fa-search"></i><span>Search</span></a>
    
    <div class="nav-item nav-menu">
      <i class="fas fa-bars"></i><span>Menu</span>
      <div class="dropdown-menu">
        <a href="#" class="dropdown-item" id="menuCategories"><i class="fas fa-tags"></i> Categories</a>
        <a href="#" class="dropdown-item" id="menuHelp"><i class="fas fa-question-circle"></i> Help</a>
        <a href="privacy.html" class="dropdown-item"><i class="fas fa-shield-alt"></i> Privacy</a>
        <a href="#" class="dropdown-item" id="menuSupport"><i class="fas fa-headset"></i> Support</a>
        <a href="premium.html" class="dropdown-item premium-item"><i class="fas fa-crown"></i> Go Premium</a>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB77EmeaPTvtXCH4EL-1E1SgmyW6Yz9lLI",
      authDomain: "cinetv257.firebaseapp.com",
      projectId: "cinetv257",
      storageBucket: "cinetv257.appspot.com",
      messagingSenderId: "402664770835",
      appId: "1:402664770835:web:1adaea98f40ca609645ee6"
    };
    
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Configuration
    const ADSTERRA_SMARTLINK = "https://www.effectivegatecpm.com/wu0xndpxcg?key=962747162b526b8e35632b7e46f1e881";
    const WATCH_URL_PREFIX = 'watch.html?id=';
    const CURRENT_YEAR = new Date().getFullYear();
    const MAX_FUTURE_YEAR = 2026;
    
    // Global variables
    let allMovies = [];
    let filteredMovies = [];
    let filters = {
      search: '',
      year: '',
      category: '',
      interpreter: '',
      sort: 'title_asc'
    };
    let currentPage = 1;
    const moviesPerPage = 16;
    let availableFilters = {
      years: new Set(),
      categories: new Set(),
      interpreters: new Set()
    };
    let searchTimeout = null;

    // Create movie card element with Font Awesome icons
    function createMovieCard(movie, key) {
      const card = document.createElement('div');
      card.className = 'movie-card';
      card.setAttribute('data-key', key);
      card.setAttribute('data-destination', WATCH_URL_PREFIX + key);

      const badgeHtml = movie.badge ? `<div class="badge">${movie.badge}</div>` : '';
      const premiumBadge = movie.premium ? `<div class="premium-badge">PREMIUM</div>` : '';
      const yearHtml = movie.year ? `<span><i class="fas fa-calendar-alt"></i> ${movie.year}</span>` : '';
      const interpreterHtml = movie.interpreter ? `<span><i class="fas fa-microphone"></i> ${movie.interpreter.substring(0, 10)}${movie.interpreter.length > 10 ? '...' : ''}</span>` : '';

      card.innerHTML = `
        <img class="movie-poster" src="${movie.imageUrl || ''}" alt="${movie.title || ''}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x450?text=No+Image'">
        ${badgeHtml}
        ${premiumBadge}
        <div class="movie-card-info">
          <div class="movie-card-title white-text">${movie.title ? movie.title.substring(0, 20) + (movie.title.length > 20 ? '...' : '') : ''}</div>
          <div class="movie-card-meta">
            ${yearHtml}
            ${interpreterHtml}
          </div>
        </div>
      `;

      // Click event for card
      card.addEventListener('click', function(e) {
        e.preventDefault();
        const destination = this.getAttribute('data-destination');
        
        // Open ad in new tab
        window.open(ADSTERRA_SMARTLINK, '_blank');
        
        // Redirect current page to content
        setTimeout(() => {
          window.location.href = destination;
        }, 300);
      });

      return card;
    }

    // Load movies from Firebase
    async function loadMovies() {
      showLoading(true);
      
      try {
        const snapshot = await db.ref('movies').once('value');
        const movies = snapshot.val() || {};
        
        // Convert to array and filter only movies (not series)
        allMovies = Object.entries(movies).filter(([_, movie]) => {
          return !movie.type || movie.type === 'movie' || movie.type === 'multi-part';
        });
        
        // Extract filter options
        extractFilterOptions(allMovies);
        
        // Populate filter dropdowns with future years support
        populateFilterDropdowns();
        
        // Initial display
        applyFilters();
        
      } catch (error) {
        console.error("Error loading movies:", error);
        showNoResults(true);
      } finally {
        showLoading(false);
      }
    }

    // Extract filter options from movies - CORRECTED
    function extractFilterOptions(movies) {
      availableFilters.years.clear();
      availableFilters.categories.clear();
      availableFilters.interpreters.clear();
      
      movies.forEach(([_, movie]) => {
        // Extract year
        if (movie.year) {
          availableFilters.years.add(movie.year.toString());
        }
        
        // Extract categories (could be array or string) - CORRECTED
        if (movie.category) {
          if (Array.isArray(movie.category)) {
            movie.category.forEach(cat => {
              if (cat && cat.trim() !== '') {
                availableFilters.categories.add(cat.trim());
              }
            });
          } else if (typeof movie.category === 'string' && movie.category.trim() !== '') {
            availableFilters.categories.add(movie.category.trim());
          }
        }
        
        // Extract interpreter
        if (movie.interpreter && movie.interpreter.trim() !== '') {
          availableFilters.interpreters.add(movie.interpreter.trim());
        }
      });
      
      // Add future years up to 2026
      for (let year = CURRENT_YEAR; year <= MAX_FUTURE_YEAR; year++) {
        availableFilters.years.add(year.toString());
      }
      
      // Sort options
      availableFilters.years = new Set([...availableFilters.years].sort((a, b) => b - a));
      availableFilters.categories = new Set([...availableFilters.categories].sort());
      availableFilters.interpreters = new Set([...availableFilters.interpreters].sort());
    }

    // Populate filter dropdowns
    function populateFilterDropdowns() {
      const yearFilter = document.getElementById('yearFilter');
      const categoryFilter = document.getElementById('categoryFilter');
      const interpreterFilter = document.getElementById('interpreterFilter');
      const sortFilter = document.getElementById('sortFilter');
      
      // Clear existing options
      yearFilter.innerHTML = '<option value="">All Years</option>';
      categoryFilter.innerHTML = '<option value="">All Categories</option>';
      interpreterFilter.innerHTML = '<option value="">All Interpreters</option>';
      
      // Populate years (including future years)
      availableFilters.years.forEach(year => {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year + (parseInt(year) > CURRENT_YEAR ? ' (Upcoming)' : '');
        yearFilter.appendChild(option);
      });
      
      // Populate categories
      availableFilters.categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        categoryFilter.appendChild(option);
      });
      
      // Populate interpreters
      availableFilters.interpreters.forEach(interpreter => {
        const option = document.createElement('option');
        option.value = interpreter;
        option.textContent = interpreter;
        interpreterFilter.appendChild(option);
      });
      
      // Set current sort
      sortFilter.value = filters.sort;
    }

    // Apply filters with real-time search - CORRECTED
    function applyFilters() {
      let tempFiltered = [...allMovies];
      
      // Search filter (titre, interprÃ¨te ET description)
      if (filters.search) {
        const searchTerm = filters.search.toLowerCase().trim();
        tempFiltered = tempFiltered.filter(([_, movie]) => {
          const titleMatch = movie.title && movie.title.toLowerCase().includes(searchTerm);
          const interpreterMatch = movie.interpreter && movie.interpreter.toLowerCase().includes(searchTerm);
          const descriptionMatch = movie.description && movie.description.toLowerCase().includes(searchTerm);
          
          return titleMatch || interpreterMatch || descriptionMatch;
        });
      }
      
      // Year filter
      if (filters.year) {
        tempFiltered = tempFiltered.filter(([_, movie]) => {
          return movie.year && movie.year.toString() === filters.year;
        });
      }
      
      // Category filter - CORRECTED
      if (filters.category) {
        tempFiltered = tempFiltered.filter(([_, movie]) => {
          if (!movie.category) return false;
          
          if (Array.isArray(movie.category)) {
            return movie.category.some(cat => cat && cat.trim() === filters.category);
          } else {
            return movie.category && movie.category.trim() === filters.category;
          }
        });
      }
      
      // Interpreter filter
      if (filters.interpreter) {
        tempFiltered = tempFiltered.filter(([_, movie]) => {
          return movie.interpreter && movie.interpreter.trim() === filters.interpreter;
        });
      }
      
      // Apply sorting
      tempFiltered = sortMovies(tempFiltered, filters.sort);
      
      filteredMovies = tempFiltered;
      
      // Update active filters display
      updateActiveFilters();
      
      // Update results info
      updateResultsInfo();
      
      // Display movies
      displayMovies();
      
      // Show/hide pagination
      setupPagination();
    }

    // Sort movies function - CORRECTED
    function sortMovies(movies, sortType) {
      return [...movies].sort((a, b) => {
        const movieA = a[1];
        const movieB = b[1];
        
        switch(sortType) {
          case 'title_asc':
            return (movieA.title || '').localeCompare(movieB.title || '');
          case 'title_desc':
            return (movieB.title || '').localeCompare(movieA.title || '');
          case 'year_desc':
            return (parseInt(movieB.year) || 0) - (parseInt(movieA.year) || 0);
          case 'year_asc':
            return (parseInt(movieA.year) || 0) - (parseInt(movieB.year) || 0);
          case 'latest':
            // Assuming timestamp or default to title for now
            return (movieB.timestamp || 0) - (movieA.timestamp || 0);
          default:
            return 0;
        }
      });
    }

    // Real-time search function
    function performRealtimeSearch() {
      if (searchTimeout) {
        clearTimeout(searchTimeout);
      }
      
      searchTimeout = setTimeout(() => {
        filters.search = document.getElementById('searchInput').value.trim();
        currentPage = 1;
        applyFilters();
      }, 300);
    }

    // Update active filters display
    function updateActiveFilters() {
      const activeFiltersContainer = document.getElementById('activeFilters');
      const noFiltersMessage = activeFiltersContainer.querySelector('.no-filters');
      
      // Remove existing chips
      const existingChips = activeFiltersContainer.querySelectorAll('.filter-chip');
      existingChips.forEach(chip => chip.remove());
      
      // Create chips for active filters
      let hasActiveFilters = false;
      
      Object.entries(filters).forEach(([key, value]) => {
        if (value && key !== 'search' && key !== 'sort') {
          hasActiveFilters = true;
          const filterChip = document.createElement('div');
          filterChip.className = 'filter-chip';
          
          let label = '';
          let icon = '';
          switch(key) {
            case 'year': 
              label = `Year: ${value}`; 
              icon = 'calendar-alt';
              break;
            case 'category': 
              label = `Category: ${value}`; 
              icon = 'tags';
              break;
            case 'interpreter': 
              label = `Interpreter: ${value}`; 
              icon = 'microphone';
              break;
          }
          
          filterChip.innerHTML = `
            <i class="fas fa-${icon}"></i>
            <span>${label}</span>
            <i class="fas fa-times" data-filter="${key}"></i>
          `;
          
          activeFiltersContainer.appendChild(filterChip);
        }
      });
      
      // Add sort filter chip
      if (filters.sort !== 'title_asc') {
        hasActiveFilters = true;
        const sortChip = document.createElement('div');
        sortChip.className = 'filter-chip';
        
        let sortLabel = '';
        switch(filters.sort) {
          case 'title_desc': sortLabel = 'Title (Z-A)'; break;
          case 'year_desc': sortLabel = 'Year (Newest)'; break;
          case 'year_asc': sortLabel = 'Year (Oldest)'; break;
          case 'latest': sortLabel = 'Latest Added'; break;
        }
        
        sortChip.innerHTML = `
          <i class="fas fa-sort-amount-down"></i>
          <span>Sort: ${sortLabel}</span>
          <i class="fas fa-times" data-filter="sort"></i>
        `;
        activeFiltersContainer.appendChild(sortChip);
      }
      
      // Show/hide "no filters" message
      if (noFiltersMessage) {
        noFiltersMessage.style.display = hasActiveFilters ? 'none' : 'block';
      }
      
      // Add event listeners to remove buttons
      activeFiltersContainer.querySelectorAll('.fa-times[data-filter]').forEach(button => {
        button.addEventListener('click', function() {
          const filterToRemove = this.getAttribute('data-filter');
          removeFilter(filterToRemove);
        });
      });
    }

    // Remove a specific filter
    function removeFilter(filterName) {
      if (filterName === 'sort') {
        filters.sort = 'title_asc';
        document.getElementById('sortFilter').value = 'title_asc';
      } else {
        filters[filterName] = '';
        if (filterName === 'category') {
          document.getElementById('categoryFilter').value = '';
        } else {
          document.getElementById(filterName + 'Filter').value = '';
        }
      }
      applyFilters();
    }

    // Clear all filters
    function clearAllFilters() {
      filters = {
        search: '',
        year: '',
        category: '',
        interpreter: '',
        sort: 'title_asc'
      };
      
      document.getElementById('searchInput').value = '';
      document.getElementById('yearFilter').value = '';
      document.getElementById('categoryFilter').value = '';
      document.getElementById('interpreterFilter').value = '';
      document.getElementById('sortFilter').value = 'title_asc';
      
      currentPage = 1;
      applyFilters();
    }

    // Apply selected filters (button click)
    function applySelectedFilters() {
      filters.year = document.getElementById('yearFilter').value;
      filters.category = document.getElementById('categoryFilter').value;
      filters.interpreter = document.getElementById('interpreterFilter').value;
      filters.sort = document.getElementById('sortFilter').value;
      
      currentPage = 1;
      applyFilters();
    }

    // Update results info
    function updateResultsInfo() {
      const resultsCount = document.getElementById('resultsCount');
      const resultsInfo = document.getElementById('resultsInfo');
      
      resultsCount.textContent = filteredMovies.length;
      
      if (filteredMovies.length === 0) {
        resultsInfo.querySelector('div').innerHTML = `
          No movies found
          <div class="realtime-indicator">
            <i class="fas fa-bolt"></i> Real-time Search
          </div>
        `;
      } else if (filteredMovies.length === 1) {
        resultsInfo.querySelector('div').innerHTML = `
          Showing 1 movie
          <div class="realtime-indicator">
            <i class="fas fa-bolt"></i> Real-time Search
          </div>
        `;
      } else {
        resultsInfo.querySelector('div').innerHTML = `
          Showing ${filteredMovies.length} movies
          <div class="realtime-indicator">
            <i class="fas fa-bolt"></i> Real-time Search
          </div>
        `;
      }
    }

    // Display movies with pagination
    function displayMovies() {
      const moviesGrid = document.getElementById('moviesGrid');
      moviesGrid.innerHTML = '';
      
      const startIndex = (currentPage - 1) * moviesPerPage;
      const endIndex = startIndex + moviesPerPage;
      const pageMovies = filteredMovies.slice(startIndex, endIndex);
      
      if (pageMovies.length === 0) {
        showNoResults(true);
        return;
      }
      
      showNoResults(false);
      
      pageMovies.forEach(([key, movie], index) => {
        const card = createMovieCard(movie, key);
        card.style.animationDelay = `${0.1 + (index * 0.05)}s`;
        moviesGrid.appendChild(card);
      });
    }

    // Setup pagination
    function setupPagination() {
      const paginationContainer = document.getElementById('pagination');
      paginationContainer.innerHTML = '';
      
      const totalPages = Math.ceil(filteredMovies.length / moviesPerPage);
      
      if (totalPages <= 1) {
        paginationContainer.style.display = 'none';
        return;
      }
      
      paginationContainer.style.display = 'flex';
      
      // Previous button
      const prevButton = document.createElement('button');
      prevButton.className = `page-btn ${currentPage === 1 ? 'disabled' : ''}`;
      prevButton.innerHTML = '<i class="fas fa-chevron-left"></i>';
      prevButton.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          displayMovies();
          updatePaginationButtons();
        }
      });
      paginationContainer.appendChild(prevButton);
      
      // Page buttons
      const maxVisiblePages = 5;
      let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
      let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
      
      if (endPage - startPage + 1 < maxVisiblePages) {
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
      }
      
      for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.className = `page-btn ${i === currentPage ? 'active' : ''}`;
        pageButton.textContent = i;
        pageButton.addEventListener('click', () => {
          currentPage = i;
          displayMovies();
          updatePaginationButtons();
        });
        paginationContainer.appendChild(pageButton);
      }
      
      // Next button
      const nextButton = document.createElement('button');
      nextButton.className = `page-btn ${currentPage === totalPages ? 'disabled' : ''}`;
      nextButton.innerHTML = '<i class="fas fa-chevron-right"></i>';
      nextButton.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          displayMovies();
          updatePaginationButtons();
        }
      });
      paginationContainer.appendChild(nextButton);
    }

    // Update pagination buttons state
    function updatePaginationButtons() {
      const totalPages = Math.ceil(filteredMovies.length / moviesPerPage);
      const buttons = document.querySelectorAll('.page-btn');
      
      buttons.forEach((button, index) => {
        button.classList.remove('active', 'disabled');
        
        if (button.textContent === currentPage.toString()) {
          button.classList.add('active');
        }
        
        if (index === 0 && currentPage === 1) {
          button.classList.add('disabled');
        }
        
        if (index === buttons.length - 1 && currentPage === totalPages) {
          button.classList.add('disabled');
        }
      });
    }

    // Show/hide loading spinner
    function showLoading(show) {
      const loadingSpinner = document.getElementById('loadingSpinner');
      loadingSpinner.style.display = show ? 'flex' : 'none';
    }

    // Show/hide no results message
    function showNoResults(show) {
      const moviesGrid = document.getElementById('moviesGrid');
      const noResults = document.getElementById('noResults');
      
      if (show) {
        moviesGrid.style.display = 'none';
        noResults.style.display = 'block';
        document.getElementById('pagination').style.display = 'none';
      } else {
        moviesGrid.style.display = 'grid';
        noResults.style.display = 'none';
      }
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      // Load movies
      loadMovies();
      
      // Real-time search input
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('input', () => {
        performRealtimeSearch();
      });
      
      // Search button event
      document.getElementById('searchButton').addEventListener('click', () => {
        filters.search = searchInput.value.trim();
        currentPage = 1;
        applyFilters();
      });
      
      // Enter key in search input
      searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          filters.search = e.target.value.trim();
          currentPage = 1;
          applyFilters();
        }
      });
      
      // Apply filters button
      document.getElementById('applyFilters').addEventListener('click', applySelectedFilters);
      
      // Clear filters button
      document.getElementById('clearFilters').addEventListener('click', clearAllFilters);
      
      // Sort filter change
      document.getElementById('sortFilter').addEventListener('change', function() {
        filters.sort = this.value;
        applyFilters();
      });
      
      // Bottom nav search
      document.getElementById('bottomSearch').addEventListener('click', (e) => {
        e.preventDefault();
        searchInput.focus();
      });
      
      // Menu functionality
      const navMenu = document.querySelector('.nav-menu');
      const dropdownMenu = document.querySelector('.dropdown-menu');
      
      navMenu.addEventListener('click', (e) => {
        e.preventDefault();
        dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!navMenu.contains(e.target)) {
          dropdownMenu.style.display = 'none';
        }
      });
      
      // Menu item clicks
      document.getElementById('menuCategories').addEventListener('click', (e) => {
        e.preventDefault();
        window.location.href = 'home.html#categoriesSection';
      });
      
      document.getElementById('menuHelp').addEventListener('click', (e) => {
        e.preventDefault();
        alert('Help Center - Frequently Asked Questions\n\n1. How to search movies?\nUse the search bar and filters above.\n\n2. How to watch movies?\nClick on any movie card.\n\n3. Is it free?\nYes, with ads. Upgrade to Premium for ad-free experience.');
      });
      
      document.getElementById('menuSupport').addEventListener('click', (e) => {
        e.preventDefault();
        alert('Support Contact:\n\nEmail: support@movieshow.com\nPhone: +257 76 38 91 63\nWhatsApp: +257 76 38 91 63\n\nWe\'re available 24/7!');
      });
    });
  </script>

  <!-- Ads System -->
  <script>
    // Ad system configuration
    const ADSTERRA_SMARTLINK = "https://www.effectivegatecpm.com/wu0xndpxcg?key=962747162b526b8e35632b7e46f1e881";
    
    // Delays in milliseconds
    const delayFirstOpen = 10 * 60 * 1000;  // 10 minutes = 600,000 ms
    const repeatInterval = 15 * 60 * 1000;   // 15 minutes = 900,000 ms

    // Function to open ad URL
    function openAdUrl() {
      window.open(ADSTERRA_SMARTLINK, '_blank');
      console.log("Opening ad URL.");
    }

    // Function to check if user is premium
    function isPremiumUser() {
      return localStorage.getItem('movieshow_premium') === 'true';
    }

    // Only run ad system for non-premium users
    if (!isPremiumUser()) {
      // 1. Schedule FIRST opening after 10 minutes
      setTimeout(() => {
        openAdUrl(); // Execute first opening
        console.log("First ad opening after 10 minutes.");

        // 2. Schedule REPEAT opening every 15 minutes
        setInterval(openAdUrl, repeatInterval);
        
      }, delayFirstOpen);
    } else {
      console.log("Premium user detected - ads disabled.");
    }
  </script>
</body>
</html>