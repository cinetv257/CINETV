<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>TV Shows - MovieShow</title>
  <link rel="icon" href="logo.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRSJ4J6W6P"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DRSJ4J6W6P');
  </script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    :root {
      --bg: #000000;
      --panel: #111111;
      --panel-2: #222222;
      --text: #ffffff;
      --muted: #aaaaaa;
      --brand: #ff3333;
      --brand-light: #ff6666;
      --brand-dark: #cc0000;
      --action: #ff3333;
      --transition: all 0.3s ease;
      --gradient: linear-gradient(135deg, #ff3333 0%, #cc0000 100%);
    }
    
    body {
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 70px;
    }

    /* ======= NAVBAR ======= */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 55px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      padding: 0 15px;
      background: #000000;
      border-bottom: 1px solid #333333;
    }
    
    .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .logo-img {
      width: 45px;
      height: 45px;
      object-fit: contain;
      filter: drop-shadow(0 0 10px rgba(255, 51, 51, 0.7));
    }
    
    /* ======= MAIN CONTENT ======= */
    .main-container {
      padding: 65px 4% 20px;
      min-height: calc(100vh - 70px);
    }

    /* ======= HEADER ======= */
    .header-section {
      text-align: center;
      margin-bottom: 25px;
    }

    .header-title {
      font-size: 1.8rem;
      color: var(--brand);
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .header-subtitle {
      color: var(--muted);
      font-size: 0.95rem;
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.5;
    }

    /* ======= FEATURED SERIES ======= */
    .featured-section {
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 1.3rem;
      color: var(--brand);
      font-weight: 700;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .featured-slider-container {
      position: relative;
      width: 100%;
      overflow: hidden;
      border-radius: 10px;
      background: #111111;
      padding: 15px 0;
      border: 1px solid #333333;
    }

    .featured-slider {
      display: flex;
      gap: 15px;
      animation: slide 40s linear infinite;
      width: max-content;
    }

    .featured-slider:hover {
      animation-play-state: paused;
    }

    @keyframes slide {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-50%);
      }
    }

    .featured-card {
      flex: 0 0 220px;
      background: #222222;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid #333333;
      position: relative;
    }

    .featured-card:hover {
      transform: translateY(-5px);
      border-color: var(--brand);
      box-shadow: 0 10px 20px rgba(255, 51, 51, 0.1);
    }

    .featured-poster {
      width: 100%;
      height: 300px;
      object-fit: cover;
      display: block;
    }

    .featured-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--brand);
      color: white;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: bold;
      z-index: 2;
    }

    .featured-info {
      padding: 15px;
    }

    .featured-title {
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .featured-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }

    .featured-meta span {
      display: flex;
      align-items: center;
      gap: 5px;
      background: rgba(255, 51, 51, 0.1);
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      color: var(--brand);
    }

    .featured-status {
      font-size: 0.8rem;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 10px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--brand);
    }

    .status-dot.ongoing {
      background: #25d366;
    }

    .status-dot.completed {
      background: #ff3333;
    }

    /* ======= SEARCH & FILTER ======= */
    .search-section {
      margin-bottom: 25px;
    }

    .search-container {
      background: #111111;
      border-radius: 10px;
      padding: 15px;
      border: 1px solid #333333;
    }

    .search-input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .search-input {
      flex: 1;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #333333;
      background: #222222;
      color: white;
      font-size: 0.9rem;
      transition: var(--transition);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 2px rgba(255, 51, 51, 0.2);
    }

    .search-btn {
      padding: 12px 20px;
      background: var(--gradient);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .search-btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .filters-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
      margin-top: 15px;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-label {
      font-size: 0.85rem;
      color: var(--muted);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-select {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #333333;
      background: #222222;
      color: white;
      font-size: 0.85rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--brand);
    }

    .active-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
      padding: 10px;
      background: rgba(255, 51, 51, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(255, 51, 51, 0.2);
      min-height: 50px;
      align-items: center;
    }

    .no-filters {
      color: var(--muted);
      font-size: 0.85rem;
      font-style: italic;
    }

    .filter-chip {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(255, 51, 51, 0.1);
      border-radius: 20px;
      font-size: 0.8rem;
      color: var(--brand);
    }

    .filter-chip i {
      cursor: pointer;
      font-size: 0.9rem;
      transition: var(--transition);
    }

    .filter-chip i:hover {
      color: white;
      transform: scale(1.1);
    }

    .clear-filters {
      padding: 8px 15px;
      background: transparent;
      border: 1px solid #333333;
      color: var(--muted);
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85rem;
      margin-top: 10px;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: center;
      width: 100%;
    }

    .clear-filters:hover {
      border-color: var(--brand);
      color: var(--brand);
    }

    .results-info {
      margin-top: 15px;
      padding: 10px;
      background: rgba(255, 51, 51, 0.05);
      border-radius: 8px;
      text-align: center;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .results-count {
      color: var(--brand);
      font-weight: 600;
    }

    /* ======= SERIES GRID ======= */
    .series-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .series-grid {
        grid-template-columns: repeat(4, 1fr);
      }
      
      .filters-container {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .featured-card {
        flex: 0 0 180px;
      }
    }

    @media (max-width: 480px) {
      .series-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }
      
      .filters-container {
        grid-template-columns: 1fr;
      }
      
      .search-input-group {
        flex-direction: column;
      }
      
      .featured-card {
        flex: 0 0 160px;
      }
      
      .featured-poster {
        height: 220px;
      }
    }

    .series-card {
      position: relative;
      background: #222222;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      aspect-ratio: 2/3;
      border: 1px solid #333333;
      animation: fadeInUp 0.5s ease forwards;
      opacity: 0;
    }

    .series-card:hover {
      transform: scale(1.03);
      border-color: var(--brand);
      box-shadow: 0 5px 15px rgba(255, 51, 51, 0.1);
    }
    
    .series-poster {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      position: relative;
      z-index: 0;
    }
    
    .series-card-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      background: linear-gradient(transparent, rgba(0, 0, 0, 0.95));
      color: white;
      z-index: 2;
    }
    
    .series-card-title {
      font-size: 0.8rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 700;
      margin-bottom: 4px;
    }
    
    .series-card-meta {
      font-size: 0.7rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 5px;
    }

    .series-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--brand);
      color: white;
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 0.65rem;
      font-weight: bold;
      z-index: 2;
    }

    .series-season {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 0.65rem;
      font-weight: bold;
      z-index: 2;
    }

    /* Animation for cards */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ======= LOADING & EMPTY STATES ======= */
    .loading-dots {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 40px 0;
    }
    
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: var(--brand);
      animation: bounce 1.4s infinite ease-in-out both;
    }
    
    .dot:nth-child(1) { animation-delay: -0.32s; }
    .dot:nth-child(2) { animation-delay: -0.16s; }
    
    @keyframes bounce {
      0%, 80%, 100% { 
        transform: scale(0);
        opacity: 0.5;
      }
      40% { 
        transform: scale(1);
        opacity: 1;
      }
    }
    
    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
      font-size: 1rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      border: 1px solid #333333;
      margin: 20px 0;
    }
    
    .no-results i {
      font-size: 3rem;
      margin-bottom: 15px;
      color: var(--brand);
      opacity: 0.5;
    }

    /* ======= PAGINATION ======= */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 30px;
      padding: 15px;
    }

    .page-btn {
      width: 35px;
      height: 35px;
      border-radius: 6px;
      border: 1px solid #333333;
      background: #222222;
      color: var(--text);
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .page-btn:hover {
      border-color: var(--brand);
      color: var(--brand);
    }

    .page-btn.active {
      background: var(--gradient);
      border-color: var(--brand);
      color: white;
    }

    .page-btn.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ======= BOTTOM NAV ======= */
    .bottom-navbar {
      position: fixed;
      inset: auto 0 0 0;
      background: #000000;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 8px 0;
      z-index: 100;
      border-top: 1px solid #333333;
    }
    
    .nav-item {
      color: var(--muted);
      text-decoration: none;
      font-size: 0.7rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      transition: var(--transition);
      padding: 6px 10px;
      border-radius: 8px;
      font-weight: 500;
      flex: 1;
      text-align: center;
      max-width: 70px;
    }
    
    .nav-item i {
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .nav-item:hover {
      color: var(--brand);
      background: rgba(255, 51, 51, 0.1);
    }
    
    .nav-item.active {
      color: var(--brand);
      background: rgba(255, 51, 51, 0.1);
    }

    /* ======= FOOTER ======= */
    footer {
      background: #000000;
      padding: 25px 4%;
      text-align: center;
      margin-top: 40px;
      border-top: 1px solid #333333;
    }

    .footer-logo {
      width: 50px;
      height: 50px;
      margin: 0 auto 15px;
      display: block;
      filter: drop-shadow(0 0 8px rgba(255, 51, 51, 0.5));
    }

    .footer-social {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 15px 0;
    }

    .social-link {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: #222222;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--brand);
      font-size: 1.1rem;
      transition: var(--transition);
      text-decoration: none;
    }

    .social-link:hover {
      background: var(--brand);
      color: white;
      transform: translateY(-2px);
    }

    .footer-bio {
      max-width: 500px;
      margin: 15px auto;
      color: var(--muted);
      line-height: 1.5;
      font-size: 0.8rem;
    }

    .copyright {
      color: var(--muted);
      font-size: 0.75rem;
      margin-top: 15px;
    }

    .designer-credit {
      color: var(--brand);
      font-size: 0.7rem;
      margin-top: 8px;
      font-style: italic;
    }
  </style>
</head>
<body>
  <!-- Top Navbar -->
  <nav class="navbar">
    <div class="logo-container">
      <img src="logo.png" class="logo-img" alt="MovieShow">
    </div>
  </nav>
  
  <!-- Main Content -->
  <div class="main-container">
    <!-- Header -->
    <section class="header-section">
      <h1 class="header-title">
        <i class="fas fa-tv"></i>
        TV Shows
      </h1>
      <p class="header-subtitle">
        Browse our collection of TV series, complete with multiple seasons and episodes. 
        All series available for streaming in high quality.
      </p>
    </section>

    <!-- Featured Series Slider -->
    <section class="featured-section">
      <h2 class="section-title">
        <i class="fas fa-star"></i>
        Featured Series
      </h2>
      <div class="featured-slider-container">
        <div class="featured-slider" id="featuredSlider"></div>
      </div>
    </section>

    <!-- Search & Filter Section -->
    <section class="search-section">
      <div class="search-container">
        <div class="search-input-group">
          <input type="text" 
                 class="search-input" 
                 id="searchInput" 
                 placeholder="Search series by title, description...">
          <button class="search-btn" id="searchButton">
            <i class="fas fa-search"></i> Search
          </button>
        </div>
        
        <div class="filters-container">
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-calendar-alt"></i> Year</label>
            <select class="filter-select" id="yearFilter">
              <option value="">All Years</option>
              <!-- Will be populated by JavaScript -->
            </select>
          </div>
          
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-tags"></i> Genre</label>
            <select class="filter-select" id="genreFilter">
              <option value="">All Genres</option>
              <!-- Will be populated by JavaScript -->
            </select>
          </div>
          
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-language"></i> Language</label>
            <select class="filter-select" id="languageFilter">
              <option value="">All Languages</option>
              <!-- Will be populated by JavaScript -->
            </select>
          </div>
          
          <div class="filter-group">
            <label class="filter-label"><i class="fas fa-clock"></i> Status</label>
            <select class="filter-select" id="statusFilter">
              <option value="">All Status</option>
              <option value="ongoing">Ongoing</option>
              <option value="completed">Completed</option>
            </select>
          </div>
        </div>
        
        <div class="active-filters" id="activeFilters">
          <div class="no-filters">No filters applied</div>
        </div>
        
        <button class="clear-filters" id="clearFilters">
          <i class="fas fa-times"></i> Clear All Filters
        </button>
      </div>
      
      <div class="results-info" id="resultsInfo">
        Showing <span class="results-count" id="resultsCount">0</span> series
      </div>
    </section>
    
    <!-- Series Grid -->
    <div class="loading-dots" id="loadingSpinner">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    
    <div id="seriesGrid" class="series-grid"></div>
    
    <div class="no-results" id="noResults" style="display: none;">
      <i class="fas fa-tv"></i>
      <h3>No series found</h3>
      <p>Try adjusting your search criteria or filters</p>
    </div>
    
    <!-- Pagination -->
    <div class="pagination" id="pagination" style="display: none;">
      <!-- Pagination buttons will be added here -->
    </div>
  </div>
  
  <!-- Footer -->
  <footer>
    <img src="logo.png" class="footer-logo" alt="MovieShow">
    
    <div class="footer-social">
      <a href="https://facebook.com/audrypaulin.dushime.7" class="social-link" target="_blank">
        <i class="fab fa-facebook-f"></i>
      </a>
      <a href="https://wa.me/25776389163" class="social-link" target="_blank">
        <i class="fab fa-whatsapp"></i>
      </a>
      <a href="mailto:support@movieshow.com" class="social-link">
        <i class="fas fa-envelope"></i>
      </a>
    </div>

    <div class="footer-bio">
      MovieShow is your ultimate streaming platform for movies and TV series. 
      Enjoy unlimited entertainment with our constantly updated library. 
      Stream anytime, anywhere on any device.
    </div>

    <div class="copyright">
      &copy; 2025 MovieShow. All rights reserved.
    </div>
    <div class="designer-credit">
      Designed by @audrypaulin
    </div>
  </footer>

  <!-- Bottom Nav -->
  <div class="bottom-navbar">
    <a href="index.html" class="nav-item"><i class="fas fa-home"></i><span>Home</span></a>
    <a href="movies.html" class="nav-item"><i class="fas fa-film"></i><span>Movies</span></a>
    <a href="tvshow.html" class="nav-item active"><i class="fas fa-tv"></i><span>Series</span></a>
    <a href="#" class="nav-item" id="bottomSearch"><i class="fas fa-search"></i><span>Search</span></a>
    
    <div class="nav-item nav-menu">
      <i class="fas fa-bars"></i><span>Menu</span>
      <div class="dropdown-menu" style="display: none;">
        <a href="#" class="dropdown-item" id="menuCategories"><i class="fas fa-tags"></i> Categories</a>
        <a href="#" class="dropdown-item" id="menuHelp"><i class="fas fa-question-circle"></i> Help</a>
        <a href="privacy.html" class="dropdown-item"><i class="fas fa-shield-alt"></i> Privacy</a>
        <a href="#" class="dropdown-item" id="menuSupport"><i class="fas fa-headset"></i> Support</a>
        <a href="premium.html" class="dropdown-item premium-item"><i class="fas fa-crown"></i> Go Premium</a>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB77EmeaPTvtXCH4EL-1E1SgmyW6Yz9lLI",
      authDomain: "cinetv257.firebaseapp.com",
      projectId: "cinetv257",
      storageBucket: "cinetv257.appspot.com",
      messagingSenderId: "402664770835",
      appId: "1:402664770835:web:1adaea98f40ca609645ee6"
    };
    
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Configuration
    const ADSTERRA_SMARTLINK = "https://www.effectivegatecpm.com/wu0xndpxcg?key=962747162b526b8e35632b7e46f1e881";
    const WATCH_URL_PREFIX = 'watch.html?id=';
    
    // Global variables
    let allSeries = [];
    let filteredSeries = [];
    let filters = {
      search: '',
      year: '',
      genre: '',
      language: '',
      status: ''
    };
    let currentPage = 1;
    const seriesPerPage = 16;
    let availableFilters = {
      years: new Set(),
      genres: new Set(),
      languages: new Set(),
      statuses: new Set(['ongoing', 'completed'])
    };
    let searchTimeout = null;

    // Create featured series card for slider
    function createFeaturedCard(series, key) {
      const card = document.createElement('div');
      card.className = 'featured-card';
      card.setAttribute('data-key', key);
      card.setAttribute('data-destination', WATCH_URL_PREFIX + key + '&episode=0');

      const episodes = series.episodes ? Object.keys(series.episodes).length : 0;
      const seasons = series.seasons || 1;
      const badgeHtml = series.badge ? `<div class="featured-badge">${series.badge}</div>` : '';
      const status = getSeriesStatus(series);
      const statusClass = status === 'ongoing' ? 'ongoing' : 'completed';
      
      card.innerHTML = `
        <img class="featured-poster" src="${series.imageUrl || ''}" alt="${series.title || ''}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x450?text=No+Image'">
        ${badgeHtml}
        <div class="featured-info">
          <h3 class="featured-title">${series.title || ''}</h3>
          <div class="featured-meta">
            ${series.year ? `<span><i class="fas fa-calendar-alt"></i> ${series.year}</span>` : ''}
            ${seasons > 1 ? `<span><i class="fas fa-layer-group"></i> ${seasons} Seasons</span>` : ''}
            ${episodes > 0 ? `<span><i class="fas fa-list-ol"></i> ${episodes} Episodes</span>` : ''}
          </div>
          <div class="featured-status">
            <div class="status-dot ${statusClass}"></div>
            <span>${status === 'ongoing' ? 'Ongoing' : 'Completed'}</span>
          </div>
        </div>
      `;

      // Click event for card
      card.addEventListener('click', function(e) {
        e.preventDefault();
        const destination = this.getAttribute('data-destination');
        
        // Open ad in new tab
        window.open(ADSTERRA_SMARTLINK, '_blank');
        
        // Redirect current page to content
        setTimeout(() => {
          window.location.href = destination;
        }, 300);
      });

      return card;
    }

    // Create series card for grid
    function createSeriesCard(series, key) {
      const card = document.createElement('div');
      card.className = 'series-card';
      card.setAttribute('data-key', key);
      card.setAttribute('data-destination', WATCH_URL_PREFIX + key + '&episode=0');

      const episodes = series.episodes ? Object.keys(series.episodes).length : 0;
      const seasons = series.seasons || 1;
      const badgeHtml = series.badge ? `<div class="series-badge">${series.badge}</div>` : '';
      const seasonHtml = seasons > 1 ? `<div class="series-season">S${seasons}</div>` : '';
      
      card.innerHTML = `
        <img class="series-poster" src="${series.imageUrl || ''}" alt="${series.title || ''}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x450?text=No+Image'">
        ${badgeHtml}
        ${seasonHtml}
        <div class="series-card-info">
          <div class="series-card-title">${series.title ? series.title.substring(0, 20) + (series.title.length > 20 ? '...' : '') : ''}</div>
          <div class="series-card-meta">
            <span>${series.year || 'N/A'}</span>
            <span>${episodes} Eps</span>
          </div>
        </div>
      `;

      // Click event for card
      card.addEventListener('click', function(e) {
        e.preventDefault();
        const destination = this.getAttribute('data-destination');
        
        // Open ad in new tab
        window.open(ADSTERRA_SMARTLINK, '_blank');
        
        // Redirect current page to content
        setTimeout(() => {
          window.location.href = destination;
        }, 300);
      });

      return card;
    }

    // Determine series status
    function getSeriesStatus(series) {
      if (series.status) {
        return series.status.toLowerCase();
      }
      
      // Determine status based on year
      const currentYear = new Date().getFullYear();
      if (series.year && parseInt(series.year) >= currentYear - 1) {
        return 'ongoing';
      }
      
      return 'completed';
    }

    // Load series from Firebase
    async function loadSeries() {
      showLoading(true);
      
      try {
        const snapshot = await db.ref('movies').once('value');
        const movies = snapshot.val() || {};
        
        // Filter only series (type === 'series' or has episodes)
        allSeries = Object.entries(movies).filter(([_, movie]) => {
          return movie.type === 'series' || (movie.episodes && Object.keys(movie.episodes).length > 0);
        });
        
        // Extract filter options
        extractFilterOptions(allSeries);
        
        // Populate filter dropdowns
        populateFilterDropdowns();
        
        // Display featured series
        displayFeaturedSeries();
        
        // Initial display
        applyFilters();
        
      } catch (error) {
        console.error("Error loading series:", error);
        showNoResults(true);
      } finally {
        showLoading(false);
      }
    }

    // Extract filter options from series
    function extractFilterOptions(series) {
      availableFilters.years.clear();
      availableFilters.genres.clear();
      availableFilters.languages.clear();
      
      series.forEach(([_, s]) => {
        // Extract year
        if (s.year) {
          availableFilters.years.add(s.year.toString());
        }
        
        // Extract genres
        if (s.category) {
          if (Array.isArray(s.category)) {
            s.category.forEach(genre => availableFilters.genres.add(genre));
          } else {
            availableFilters.genres.add(s.category);
          }
        }
        
        // Extract language
        if (s.language) {
          if (Array.isArray(s.language)) {
            s.language.forEach(lang => availableFilters.languages.add(lang));
          } else {
            availableFilters.languages.add(s.language);
          }
        }
        
        // Determine status
        const status = getSeriesStatus(s);
        availableFilters.statuses.add(status);
      });
      
      // Sort options
      availableFilters.years = new Set([...availableFilters.years].sort((a, b) => b - a));
      availableFilters.genres = new Set([...availableFilters.genres].sort());
      availableFilters.languages = new Set([...availableFilters.languages].sort());
    }

    // Populate filter dropdowns
    function populateFilterDropdowns() {
      const yearFilter = document.getElementById('yearFilter');
      const genreFilter = document.getElementById('genreFilter');
      const languageFilter = document.getElementById('languageFilter');
      
      // Clear existing options
      yearFilter.innerHTML = '<option value="">All Years</option>';
      genreFilter.innerHTML = '<option value="">All Genres</option>';
      languageFilter.innerHTML = '<option value="">All Languages</option>';
      
      // Populate years
      availableFilters.years.forEach(year => {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearFilter.appendChild(option);
      });
      
      // Populate genres
      availableFilters.genres.forEach(genre => {
        const option = document.createElement('option');
        option.value = genre;
        option.textContent = genre;
        genreFilter.appendChild(option);
      });
      
      // Populate languages
      availableFilters.languages.forEach(language => {
        const option = document.createElement('option');
        option.value = language;
        option.textContent = language;
        languageFilter.appendChild(option);
      });
    }

    // Display featured series in slider
    function displayFeaturedSeries() {
      const slider = document.getElementById('featuredSlider');
      slider.innerHTML = '';
      
      // Get featured series (first 10 series)
      const featured = allSeries.slice(0, 10);
      
      // Create duplicate for seamless scrolling
      featured.forEach(([key, series]) => {
        slider.appendChild(createFeaturedCard(series, key));
      });
      
      // Duplicate for infinite scroll effect
      featured.forEach(([key, series]) => {
        slider.appendChild(createFeaturedCard(series, key));
      });
    }

    // Apply filters
    function applyFilters() {
      filteredSeries = allSeries.filter(([_, series]) => {
        // Search filter
        if (filters.search) {
          const searchTerm = filters.search.toLowerCase();
          const titleMatch = series.title && series.title.toLowerCase().includes(searchTerm);
          const descriptionMatch = series.description && series.description.toLowerCase().includes(searchTerm);
          
          if (!titleMatch && !descriptionMatch) return false;
        }
        
        // Year filter
        if (filters.year && series.year !== filters.year) {
          return false;
        }
        
        // Genre filter
        if (filters.genre) {
          if (!series.category) return false;
          
          if (Array.isArray(series.category)) {
            if (!series.category.includes(filters.genre)) return false;
          } else {
            if (series.category !== filters.genre) return false;
          }
        }
        
        // Language filter
        if (filters.language) {
          if (!series.language) return false;
          
          if (Array.isArray(series.language)) {
            if (!series.language.includes(filters.language)) return false;
          } else {
            if (series.language !== filters.language) return false;
          }
        }
        
        // Status filter
        if (filters.status) {
          const seriesStatus = getSeriesStatus(series);
          if (seriesStatus !== filters.status) return false;
        }
        
        return true;
      });
      
      // Update active filters display
      updateActiveFilters();
      
      // Update results info
      updateResultsInfo();
      
      // Display series
      displaySeries();
      
      // Show/hide pagination
      setupPagination();
    }

    // Real-time search function
    function performRealtimeSearch() {
      if (searchTimeout) {
        clearTimeout(searchTimeout);
      }
      
      searchTimeout = setTimeout(() => {
        filters.search = document.getElementById('searchInput').value.trim();
        currentPage = 1;
        applyFilters();
      }, 300);
    }

    // Update active filters display
    function updateActiveFilters() {
      const activeFiltersContainer = document.getElementById('activeFilters');
      const noFiltersMessage = activeFiltersContainer.querySelector('.no-filters');
      
      // Remove existing chips
      const existingChips = activeFiltersContainer.querySelectorAll('.filter-chip');
      existingChips.forEach(chip => chip.remove());
      
      // Create chips for active filters
      let hasActiveFilters = false;
      
      Object.entries(filters).forEach(([key, value]) => {
        if (value && key !== 'search') {
          hasActiveFilters = true;
          const filterChip = document.createElement('div');
          filterChip.className = 'filter-chip';
          
          let label = '';
          let icon = '';
          switch(key) {
            case 'year': 
              label = `Year: ${value}`; 
              icon = 'calendar-alt';
              break;
            case 'genre': 
              label = `Genre: ${value}`; 
              icon = 'tags';
              break;
            case 'language': 
              label = `Language: ${value}`; 
              icon = 'language';
              break;
            case 'status': 
              label = `Status: ${value === 'ongoing' ? 'Ongoing' : 'Completed'}`; 
              icon = 'clock';
              break;
          }
          
          filterChip.innerHTML = `
            <i class="fas fa-${icon}"></i>
            <span>${label}</span>
            <i class="fas fa-times" data-filter="${key}"></i>
          `;
          
          activeFiltersContainer.appendChild(filterChip);
        }
      });
      
      // Show/hide "no filters" message
      if (noFiltersMessage) {
        noFiltersMessage.style.display = hasActiveFilters ? 'none' : 'block';
      }
      
      // Add event listeners to remove buttons
      activeFiltersContainer.querySelectorAll('.fa-times[data-filter]').forEach(button => {
        button.addEventListener('click', function() {
          const filterToRemove = this.getAttribute('data-filter');
          removeFilter(filterToRemove);
        });
      });
    }

    // Remove a specific filter
    function removeFilter(filterName) {
      filters[filterName] = '';
      document.getElementById(filterName + 'Filter').value = '';
      applyFilters();
    }

    // Clear all filters
    function clearAllFilters() {
      filters = {
        search: '',
        year: '',
        genre: '',
        language: '',
        status: ''
      };
      
      document.getElementById('searchInput').value = '';
      document.getElementById('yearFilter').value = '';
      document.getElementById('genreFilter').value = '';
      document.getElementById('languageFilter').value = '';
      document.getElementById('statusFilter').value = '';
      
      applyFilters();
    }

    // Update results info
    function updateResultsInfo() {
      const resultsCount = document.getElementById('resultsCount');
      const resultsInfo = document.getElementById('resultsInfo');
      
      resultsCount.textContent = filteredSeries.length;
      
      if (filteredSeries.length === 0) {
        resultsInfo.textContent = 'No series found';
      } else if (filteredSeries.length === 1) {
        resultsInfo.textContent = 'Showing 1 series';
      } else {
        resultsInfo.textContent = `Showing ${filteredSeries.length} series`;
      }
    }

    // Display series with pagination
    function displaySeries() {
      const seriesGrid = document.getElementById('seriesGrid');
      seriesGrid.innerHTML = '';
      
      const startIndex = (currentPage - 1) * seriesPerPage;
      const endIndex = startIndex + seriesPerPage;
      const pageSeries = filteredSeries.slice(startIndex, endIndex);
      
      if (pageSeries.length === 0) {
        showNoResults(true);
        return;
      }
      
      showNoResults(false);
      
      pageSeries.forEach(([key, series], index) => {
        const card = createSeriesCard(series, key);
        card.style.animationDelay = `${0.1 + (index * 0.05)}s`;
        seriesGrid.appendChild(card);
      });
    }

    // Setup pagination
    function setupPagination() {
      const paginationContainer = document.getElementById('pagination');
      paginationContainer.innerHTML = '';
      
      const totalPages = Math.ceil(filteredSeries.length / seriesPerPage);
      
      if (totalPages <= 1) {
        paginationContainer.style.display = 'none';
        return;
      }
      
      paginationContainer.style.display = 'flex';
      
      // Previous button
      const prevButton = document.createElement('button');
      prevButton.className = `page-btn ${currentPage === 1 ? 'disabled' : ''}`;
      prevButton.innerHTML = '<i class="fas fa-chevron-left"></i>';
      prevButton.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          displaySeries();
          updatePaginationButtons();
        }
      });
      paginationContainer.appendChild(prevButton);
      
      // Page buttons
      const maxVisiblePages = 5;
      let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
      let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
      
      if (endPage - startPage + 1 < maxVisiblePages) {
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
      }
      
      for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.className = `page-btn ${i === currentPage ? 'active' : ''}`;
        pageButton.textContent = i;
        pageButton.addEventListener('click', () => {
          currentPage = i;
          displaySeries();
          updatePaginationButtons();
        });
        paginationContainer.appendChild(pageButton);
      }
      
      // Next button
      const nextButton = document.createElement('button');
      nextButton.className = `page-btn ${currentPage === totalPages ? 'disabled' : ''}`;
      nextButton.innerHTML = '<i class="fas fa-chevron-right"></i>';
      nextButton.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          displaySeries();
          updatePaginationButtons();
        }
      });
      paginationContainer.appendChild(nextButton);
    }

    // Update pagination buttons state
    function updatePaginationButtons() {
      const totalPages = Math.ceil(filteredSeries.length / seriesPerPage);
      const buttons = document.querySelectorAll('.page-btn');
      
      buttons.forEach((button, index) => {
        button.classList.remove('active', 'disabled');
        
        if (button.textContent === currentPage.toString()) {
          button.classList.add('active');
        }
        
        if (index === 0 && currentPage === 1) {
          button.classList.add('disabled');
        }
        
        if (index === buttons.length - 1 && currentPage === totalPages) {
          button.classList.add('disabled');
        }
      });
    }

    // Show/hide loading spinner
    function showLoading(show) {
      const loadingSpinner = document.getElementById('loadingSpinner');
      loadingSpinner.style.display = show ? 'flex' : 'none';
    }

    // Show/hide no results message
    function showNoResults(show) {
      const seriesGrid = document.getElementById('seriesGrid');
      const noResults = document.getElementById('noResults');
      
      if (show) {
        seriesGrid.style.display = 'none';
        noResults.style.display = 'block';
        document.getElementById('pagination').style.display = 'none';
      } else {
        seriesGrid.style.display = 'grid';
        noResults.style.display = 'none';
      }
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      // Load series
      loadSeries();
      
      // Real-time search input
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('input', performRealtimeSearch);
      
      // Search button event
      document.getElementById('searchButton').addEventListener('click', () => {
        filters.search = searchInput.value.trim();
        currentPage = 1;
        applyFilters();
      });
      
      // Enter key in search input
      searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          filters.search = e.target.value.trim();
          currentPage = 1;
          applyFilters();
        }
      });
      
      // Filter change events
      document.getElementById('yearFilter').addEventListener('change', (e) => {
        filters.year = e.target.value;
        currentPage = 1;
        applyFilters();
      });
      
      document.getElementById('genreFilter').addEventListener('change', (e) => {
        filters.genre = e.target.value;
        currentPage = 1;
        applyFilters();
      });
      
      document.getElementById('languageFilter').addEventListener('change', (e) => {
        filters.language = e.target.value;
        currentPage = 1;
        applyFilters();
      });
      
      document.getElementById('statusFilter').addEventListener('change', (e) => {
        filters.status = e.target.value;
        currentPage = 1;
        applyFilters();
      });
      
      // Clear filters button
      document.getElementById('clearFilters').addEventListener('click', clearAllFilters);
      
      // Bottom nav search
      document.getElementById('bottomSearch').addEventListener('click', (e) => {
        e.preventDefault();
        searchInput.focus();
      });
      
      // Menu functionality
      const navMenu = document.querySelector('.nav-menu');
      const dropdownMenu = document.querySelector('.dropdown-menu');
      
      navMenu.addEventListener('click', (e) => {
        e.preventDefault();
        dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!navMenu.contains(e.target)) {
          dropdownMenu.style.display = 'none';
        }
      });
      
      // Menu item clicks
      document.getElementById('menuCategories').addEventListener('click', (e) => {
        e.preventDefault();
        window.location.href = 'index.html#categoriesSection';
      });
      
      document.getElementById('menuHelp').addEventListener('click', (e) => {
        e.preventDefault();
        alert('TV Shows Help Center\n\n1. How to watch series?\nClick on any series card to watch.\n\n2. How are episodes organized?\nSeries have seasons and episodes accessible from the player page.\n\n3. Is it free?\nYes, with ads. Upgrade to Premium for ad-free experience.');
      });
      
      document.getElementById('menuSupport').addEventListener('click', (e) => {
        e.preventDefault();
        alert('Support Contact:\n\nEmail: support@movieshow.com\nPhone: +257 76 38 91 63\nWhatsApp: +257 76 38 9163\n\nWe\'re available 24/7!');
      });
    });
  </script>
</body>
</html>